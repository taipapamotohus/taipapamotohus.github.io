<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.4.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="taipapa">

  
  
  
    
  
  <meta name="description" content="論文というものはすぐにたまる．読みもしないのにどんどんたまる．21世紀に入った頃は論文のプリントアウトの山ができて定期的に捨てたりしていたのだが，それも今は昔，現在はpdfの時代であり，かなり前からpdfで読んで，注釈など書き込んだりするようになった．しかし，どんどんたまるのは昔以上である．何しろ取るスペースはディスクの容量だけで，物理空間を占拠するわけではないから，いくらでも気兼ねなくため込める．ため込んだ論文数が数千を越えるあたりで，ふと思うわけである．「これを全て読むのは不可能としても，全文検索ができたら便利だろうなぁ．．．」
という訳で，今回は，hyperestraierを使ってため込んだpdfの全文検索をできるようにしようという話である．">

  
  <link rel="alternate" hreflang="en-us" href="/post/fulltextsearch/">

  


  

  
  
  
  <meta name="theme-color" content="#EF525B">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.0/css/all.css" integrity="sha384-aOkxzJ5uQz7WBObEZcHvV5JvRW3TUc2rNPA7pe3AwnsUohiw1Vj2Rgx2KSOkF5+h" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/zenburn.min.css" crossorigin="anonymous" title="hl-light">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/zenburn.min.css" crossorigin="anonymous" title="hl-dark" disabled>
      
    

    

    

  

  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700|Roboto:400,400italic,700|Roboto+Mono&display=swap">
  

  
  
  
  <link rel="stylesheet" href="/css/academic.min.78c6d66dd9441acddcacbbdd5a1f423a.css">

  

  
  
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-126592193-1', 'auto');
      
      ga('require', 'eventTracker');
      ga('require', 'outboundLinkTracker');
      ga('require', 'urlChangeTracker');
      ga('send', 'pageview');
    </script>
    <script async src="https://www.google-analytics.com/analytics.js"></script>
    
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/autotrack/2.4.1/autotrack.js" integrity="sha512-HUmooslVKj4m6OBu0OgzjXXr+QuFYy/k7eLI5jdeEy/F4RSgMn6XRWRGkFi5IFaFgy7uFTkegp3Z0XnJf3Jq+g==" crossorigin="anonymous"></script>
    
  
  

  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon-32.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="/post/fulltextsearch/">

  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="og:site_name" content="A perfect autumn day">
  <meta property="og:url" content="/post/fulltextsearch/">
  <meta property="og:title" content="Full text search of PDF archives with hyperestraier on maos (mojave) — Hyper Estraierでpdfの全文検索を行う | A perfect autumn day">
  <meta property="og:description" content="論文というものはすぐにたまる．読みもしないのにどんどんたまる．21世紀に入った頃は論文のプリントアウトの山ができて定期的に捨てたりしていたのだが，それも今は昔，現在はpdfの時代であり，かなり前からpdfで読んで，注釈など書き込んだりするようになった．しかし，どんどんたまるのは昔以上である．何しろ取るスペースはディスクの容量だけで，物理空間を占拠するわけではないから，いくらでも気兼ねなくため込める．ため込んだ論文数が数千を越えるあたりで，ふと思うわけである．「これを全て読むのは不可能としても，全文検索ができたら便利だろうなぁ．．．」
という訳で，今回は，hyperestraierを使ってため込んだpdfの全文検索をできるようにしようという話である．"><meta property="og:image" content="/post/fulltextsearch/featured.jpg">
  <meta property="twitter:image" content="/post/fulltextsearch/featured.jpg"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2019-07-24T00:00:00&#43;09:00">
    
    <meta property="article:modified_time" content="2019-09-17T21:59:41&#43;09:00">
  

  


  





  <title>Full text search of PDF archives with hyperestraier on maos (mojave) — Hyper Estraierでpdfの全文検索を行う | A perfect autumn day</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  
<nav class="navbar navbar-light fixed-top navbar-expand-lg py-0 compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
      <a class="navbar-brand" href="/">A perfect autumn day</a>
      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
        <span><i class="fas fa-bars"></i></span>
      </button>
      

    
    <div class="collapse navbar-collapse" id="navbar">

      
      
      <ul class="navbar-nav mr-auto">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#about"><span>Home</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>Posts</span></a>
        </li>

        
        

      
      </ul>
      <ul class="navbar-nav ml-auto">
      

        

        
        <li class="nav-item">
          <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        

        
        <li class="nav-item">
          <a class="nav-link js-dark-toggle" href="#"><i class="fas fa-moon" aria-hidden="true"></i></a>
        </li>
        

      </ul>

    </div>
  </div>
</nav>


  <article class="article" itemscope itemtype="http://schema.org/Article">

  




















  
  


<div class="article-container pt-3">
  <h1 itemprop="name">Full text search of PDF archives with hyperestraier on maos (mojave) — Hyper Estraierでpdfの全文検索を行う</h1>

  
  <p class="page-subtitle">（2019年9月17日修正あり）</p>
  

  



<meta content="2019-07-24 00:00:00 &#43;0900 JST" itemprop="datePublished">
<meta content="2019-09-17 21:59:41 &#43;0900 JST" itemprop="dateModified">

<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
          Last updated on
      
    
    <time>Sep 17, 2019</time>
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    7 min read
  </span>
  

  
  
  
  <span class="middot-divider"></span>
  <a href="/post/fulltextsearch/#disqus_thread"></a>
  

  
  

  
    

  

</div>

  














</div>


<div class="article-header container-fluid featured-image-wrapper mt-4 mb-4" style="max-width: 2750px; max-height: 668px;">
  <div style="position: relative">
    <img src="/post/fulltextsearch/featured.jpg" alt="" class="featured-image">
    <span class="article-header-caption">Attica, Greece</span>
  </div>
</div>



  <div class="article-container">

    <div class="article-style" itemprop="articleBody">
      <p>論文というものはすぐにたまる．読みもしないのにどんどんたまる．21世紀に入った頃は論文のプリントアウトの山ができて定期的に捨てたりしていたのだが，それも今は昔，現在はpdfの時代であり，かなり前からpdfで読んで，注釈など書き込んだりするようになった．しかし，どんどんたまるのは昔以上である．何しろ取るスペースはディスクの容量だけで，物理空間を占拠するわけではないから，いくらでも気兼ねなくため込める．ため込んだ論文数が数千を越えるあたりで，ふと思うわけである．「これを全て読むのは不可能としても，全文検索ができたら便利だろうなぁ．．．」</p>
<p>という訳で，今回は，hyperestraierを使ってため込んだpdfの全文検索をできるようにしようという話である．</p>
<p>hyperestraierをインストールし，Apacheをセットアップして，pdf文書のインデックスを作成し，これをブラウザで検索できるようにするという流れでまとめていく．</p>
<p><strong>セットアップは結構面倒だが，非常に便利で，オススメである！</strong></p>
<p>なお，以下の手順は，MacBook Pro (15-inch, Late 2016) Mojave 10.14.6，および，iMac 2012 Mojave 10.14.6 の両方で確認済みである．</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<ul>
<li><a href="#references">References</a></li>
<li><a href="#hyper-estraier">Hyper Estraier</a>
<ul>
<li><a href="#install">Install</a></li>
<li><a href="#pdftotext">pdftotext</a></li>
<li><a href="#%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E7%94%A8%E3%81%AE%E3%82%A6%E3%82%A7%E3%83%96%E3%83%87%E3%82%A3%E3%83%AC%E3%82%AF%E3%83%88%E3%83%AA%E3%81%AE%E4%BD%9C%E6%88%90">ユーザー用のウェブディレクトリの作成</a></li>
<li><a href="#%E5%85%A8%E6%96%87%E6%A4%9C%E7%B4%A2%E7%94%A8%E3%81%AE%E3%83%87%E3%82%A3%E3%83%AC%E3%82%AF%E3%83%88%E3%83%AA%E3%81%AE%E4%BD%9C%E6%88%90">全文検索用のディレクトリの作成</a></li>
<li><a href="#%E5%85%A8%E6%96%87%E6%A4%9C%E7%B4%A2%E7%94%A8%E3%81%AEindex%E3%81%AE%E4%BD%9C%E6%88%90">全文検索用のindexの作成</a></li>
<li><a href="#index%E3%81%AE%E6%9B%B4%E6%96%B0">indexの更新</a></li>
<li><a href="#%E6%A4%9C%E7%B4%A2%E3%81%AE%E3%83%86%E3%82%B9%E3%83%88">検索のテスト</a></li>
</ul>
</li>
<li><a href="#apache-set-up">Apache set up</a>
<ul>
<li><a href="#cgi-%E3%82%92%E8%A8%B1%E5%8F%AF%E3%81%99%E3%82%8B%E3%82%88%E3%81%86%E3%81%AB-apache-%E3%82%92%E8%A8%AD%E5%AE%9A%E3%81%99%E3%82%8B">CGI を許可するように Apache を設定する</a></li>
<li><a href="#apache%E3%81%AE%E8%B5%B7%E5%8B%95-%E5%86%8D%E8%B5%B7%E5%8B%95">Apacheの起動，再起動</a></li>
<li><a href="#cgi%E3%81%8C%E5%8B%95%E3%81%8F%E3%81%8B%E3%81%A9%E3%81%86%E3%81%8B%E3%81%AE%E3%83%86%E3%82%B9%E3%83%88">CGIが動くかどうかのテスト</a></li>
<li><a href="#documentroot">DocumentRoot</a></li>
<li><a href="#%E3%83%A6%E3%83%BC%E3%82%B6%E6%AF%8E%E3%81%AE%E3%82%A6%E3%82%A7%E3%83%96%E3%83%87%E3%82%A3%E3%83%AC%E3%82%AF%E3%83%88%E3%83%AA">ユーザ毎のウェブディレクトリ</a></li>
</ul>
</li>
<li><a href="#hyperestraier%E4%BB%98%E5%B1%9E%E3%81%AE%E5%85%A8%E6%96%87%E6%A4%9C%E7%B4%A2%E7%94%A8cgi-script%E3%81%AEset-up">Hyperestraier付属の全文検索用CGI scriptのset up</a></li>
</ul>
<!-- raw HTML omitted -->
<h2 id="references">References</h2>
<ul>
<li><a href="https://skalldan.wordpress.com/2011/06/28/hyper-estraier-%E3%81%A7%E4%BB%8F%E5%85%B8%E6%8E%A2%E7%B4%A2/">Hyper Estraier で仏典探索</a>     Amrtaさんのものすごく役に立つサイト</li>
<li><a href="https://skalldan.wordpress.com/2011/07/01/hyper-estraier-%E3%81%A7-pdf-%E6%96%87%E6%9B%B8%E7%AE%A1%E7%90%86/">Hyper Estraier で PDF 管理</a>    これまた，Amrtaさんの物凄く役に立つサイト．以上の2つを読めば，このサイトを見る必要はないような．．．(^^;;;</li>
</ul>
<p>sudoしてrootになるのはイヤ，普通のユーザーとしてapacheを使ってブラウザで全文検索をしたいという人は，この先を読むと参考になるかもしれない．</p>
<h2 id="hyper-estraier">Hyper Estraier</h2>
<p>今回用いるのは<a href="https://fallabs.com/hyperestraier/index.ja.html">Hyper Estraier</a>という全文検索システムである．これがどんなものかはリンク先の文書を読んでもらうとして，早速インストールである．</p>
<h3 id="install">Install</h3>
<p>homebrewを使用すれば一発である．qdbmなどの依存関係も全部面倒を見てくれるので楽である．</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ brew install hyperestraier
</code></pre></div><p>インストールされたものを見るとこうなっている．</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ brew info hyperestraier

hyperestraier: stable 1.4.13 <span style="color:#f92672">(</span>bottled<span style="color:#f92672">)</span>
Full-text search system <span style="color:#66d9ef">for</span> communities
https://fallabs.com/hyperestraier/
/usr/local/Cellar/hyperestraier/1.4.13 <span style="color:#f92672">(</span><span style="color:#ae81ff">278</span> files, 3.1MB<span style="color:#f92672">)</span> *
Built from source on 2016-12-24 at 22:34:54 with: --with-mecab
From: https://github.com/Homebrew/homebrew-core/blob/master/Formula/hyperestraier.rb
<span style="color:#f92672">=</span><span style="color:#f92672">=</span>&gt; Dependencies
Required: qdbm
<span style="color:#f92672">=</span><span style="color:#f92672">=</span>&gt; Analytics
install: <span style="color:#ae81ff">3</span> <span style="color:#f92672">(</span><span style="color:#ae81ff">30</span> days<span style="color:#f92672">)</span>, <span style="color:#ae81ff">16</span> <span style="color:#f92672">(</span><span style="color:#ae81ff">90</span> days<span style="color:#f92672">)</span>, <span style="color:#ae81ff">64</span> <span style="color:#f92672">(</span><span style="color:#ae81ff">365</span> days<span style="color:#f92672">)</span>
install_on_request: <span style="color:#ae81ff">3</span> <span style="color:#f92672">(</span><span style="color:#ae81ff">30</span> days<span style="color:#f92672">)</span>, <span style="color:#ae81ff">16</span> <span style="color:#f92672">(</span><span style="color:#ae81ff">90</span> days<span style="color:#f92672">)</span>, <span style="color:#ae81ff">64</span> <span style="color:#f92672">(</span><span style="color:#ae81ff">365</span> days<span style="color:#f92672">)</span>
build_error: <span style="color:#ae81ff">0</span> <span style="color:#f92672">(</span><span style="color:#ae81ff">30</span> days<span style="color:#f92672">)</span>
</code></pre></div><p>pdfのindexを作成する際に，hyperestraierに含まれているestfxpdftohtmlというフィルタでPDFのファイルをHTML形式に変換する．しかし，このフィルタは/usr/local/bin/などには入ってくれないので，brewによりインストールされた場所を探して，pathの通るところにsymbolic linkを張っておく．</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ mdfind -name filter | grep hyperestraier
/usr/local/Cellar/hyperestraier/1.4.13/share/hyperestraier/filter

$ ls -al /usr/local/Cellar/hyperestraier/1.4.13/share/hyperestraier/filter
total <span style="color:#ae81ff">48</span>
drwxr-xr-x   <span style="color:#ae81ff">8</span> kohkichi  admin   <span style="color:#ae81ff">256</span> Feb <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2017</span> ./
drwxr-xr-x  <span style="color:#ae81ff">19</span> kohkichi  admin   <span style="color:#ae81ff">608</span> Dec <span style="color:#ae81ff">24</span>  <span style="color:#ae81ff">2016</span> ../
-rwxr-xr-x   <span style="color:#ae81ff">1</span> kohkichi  admin  <span style="color:#ae81ff">1118</span> Dec <span style="color:#ae81ff">24</span>  <span style="color:#ae81ff">2016</span> estfxasis*
-rwxr-xr-x   <span style="color:#ae81ff">1</span> kohkichi  admin  <span style="color:#ae81ff">1063</span> Dec <span style="color:#ae81ff">24</span>  <span style="color:#ae81ff">2016</span> estfxmantotxt*
-rwxr-xr-x   <span style="color:#ae81ff">1</span> kohkichi  admin  <span style="color:#ae81ff">1263</span> Dec <span style="color:#ae81ff">24</span>  <span style="color:#ae81ff">2016</span> estfxmsotohtml*
-rwxr-xr-x   <span style="color:#ae81ff">1</span> kohkichi  admin  <span style="color:#ae81ff">1016</span> Dec <span style="color:#ae81ff">24</span>  <span style="color:#ae81ff">2016</span> estfxpdftohtml*
-rwxr-xr-x   <span style="color:#ae81ff">1</span> kohkichi  admin  <span style="color:#ae81ff">1007</span> Dec <span style="color:#ae81ff">24</span>  <span style="color:#ae81ff">2016</span> estfxxdwtotxt*
-rwxr-xr-x   <span style="color:#ae81ff">1</span> kohkichi  admin  <span style="color:#ae81ff">1057</span> Dec <span style="color:#ae81ff">24</span>  <span style="color:#ae81ff">2016</span> estwnetxpnd*

$ ln -s /usr/local/Cellar/hyperestraier/1.4.13/share/hyperestraier/filter/* /usr/local/bin/
</code></pre></div><h3 id="pdftotext">pdftotext</h3>
<p>上述のestfxpdftohtmlであるが，内部でpdftotextを使用している．そして，厄介なことに，このpdftotextはxpdfとpopplerの両方に含まれている．しかも，xpdfに含まれているpdftotextには <strong>-htmlmeta</strong> optionがないのである．つまり， <strong>xpdfに含まれているpdftotextを使用するとpdf文書のindexができない</strong> ということになる．実際にそれぞれのversionを見てみると，</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#e6db74">&lt;&lt;xpdf&gt;&gt;
</span><span style="color:#e6db74">$ pdftotex</span>t -h
pdftotext version 4.01.01
Copyright 1996-2019 Glyph &amp; Cog, LLC
..........

<span style="color:#e6db74">&lt;&lt;poppler&gt;&gt;
</span><span style="color:#e6db74">$ pdftotext -h
</span><span style="color:#e6db74">pdftotext version 0.77.0
</span><span style="color:#e6db74">Copyright 2005-2019 The Poppler Developers - http://poppler</span>.freedesktop.org
Copyright 1996-2011 Glyph &amp; Cog, LLC
..........
</code></pre></div><p>このように，全く異なったものになっているが，どうやら，xpdfのものの方が古いらしい．もし，xpdfをすでに入れている場合は，popplerをインストールしようとすると，</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ brew install poppler

Error: Cannot install poppler because conflicting formulae are installed.
xpdf: because poppler, pdftohtml, pdf2image, and xpdf install conflicting executables

Please <span style="color:#e6db74">`</span>brew unlink xpdf<span style="color:#e6db74">`</span> before continuing.
</code></pre></div><p>と怒られるので，言われる通りに brew unlink xpdf してから，再度，brew install popplerを行えば良い．これで，popplerの方のpdftotextが使われるようになって，ちゃんとindexができるようになる．私は2台あるMacの片方でだけ何故かindexが作成できないので，原因を調べているうちにこのことに気がついたが，ネットで他に触れている記事が見当たらないので，ここにまとめておく．</p>
<p>また，このようにしてxpdfとpopplerをインストールしていると，<a href="../pdf-tools/#%E8%BF%BD%E8%A8%98-2019%E5%B9%B47%E6%9C%8817%E6%97%A5"> Emacsでpdfを読む (pdf-tools) (2019.07.17追記)</a>に書いたように，pdf-toolをコンパイルする際に「libffiがどこにあるか分からん」というようなエラーメッセージが出ることがある．その際の対処法は，<a href="../pdf-tools/#%E8%BF%BD%E8%A8%98-2019%E5%B9%B47%E6%9C%8817%E6%97%A5"> Emacsでpdfを読む (pdf-tools) (2019.07.17追記)</a>に書いたとおりである．</p>
<h3 id="ユーザー用のウェブディレクトリの作成">ユーザー用のウェブディレクトリの作成</h3>
<p>まず，Apacheを用いてブラウザで検索できるように（これについては後述），自分のhome directoryにSitesというdirectoryを作成する．</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ cd ~
$ mkdir Sites
$ cd Sites
$ pwd
/Users/taipapa/Sites
</code></pre></div><p>Apacheの設定のところで述べるが，このSitesというディレクトリにウェブサイトを構築できるように設定し，WWW ブラウザで全文検索できるようにする．</p>
<h3 id="全文検索用のディレクトリの作成">全文検索用のディレクトリの作成</h3>
<p>Sites ディレクトリの中に全文検索用のディレクトリを作成する．ここではpdfファイルの全文検索を行うので，pdfという名前にした．さらに，pdf ディレクトリの中に全文検索の対象となるpdfを集約するためのPDFsというディレクトリを作成する．</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ cd ~/Sites
$ mkdir pdf
$ cd pdf
$ mkdir PDFs
</code></pre></div><h4 id="pdfsディレクトリへのpdfの集約">PDFsディレクトリへのpdfの集約</h4>
<p>さて，pdfは，大抵の場合，いくつかのディレクトリに分けて置いてあるであろう．それを全て1箇所に集約して全文検索ができるようにするために，シンボリックリンクを使用する．具体的には，pdfのあるディレクトリが，/Data/hogehoge, /Data/fugaguga, /Data/misc とすると，以下のようにする．</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ cd /Users/taipapa/Sites/pdf/PDFs
$ ln -s /Data/hogehoge .
$ ln -s /Data/fugafuga .
$ ln -s /Data/misc .
</code></pre></div><h3 id="全文検索用のindexの作成">全文検索用のindexの作成</h3>
<p>hyperestraierのestcmdを用いて，空のindexを作成する．名前はマニュアルの真似をしてcasketとする（わかれば何でも良いと思う）．これはpdfの配下でPDFsと同じレベルに置く</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ pwd
/Users/taipapa/Sites/pdf
$ estcmd create casket
$ ls -la
total <span style="color:#ae81ff">24</span>
drwxr-xr-x   <span style="color:#ae81ff">5</span> taipapa  staff   <span style="color:#ae81ff">160</span> Jul <span style="color:#ae81ff">29</span> 20:34 .
drwxr-xr-x   <span style="color:#ae81ff">8</span> taipapa  staff   <span style="color:#ae81ff">256</span> Aug  <span style="color:#ae81ff">4</span> 22:19 ..
-rw-r--r--@  <span style="color:#ae81ff">1</span> taipapa  staff  <span style="color:#ae81ff">8196</span> Aug  <span style="color:#ae81ff">5</span> 22:12 .DS_Store
drwxr-xr-x  <span style="color:#ae81ff">10</span> taipapa  staff   <span style="color:#ae81ff">320</span> Jul <span style="color:#ae81ff">29</span> 20:21 PDFs
drwxr-xr-x  <span style="color:#ae81ff">11</span> taipapa  staff   <span style="color:#ae81ff">352</span> Jul <span style="color:#ae81ff">29</span> 21:14 casket
</code></pre></div><p>これでようやく，indexを作成する準備が整った．後は以下のように叩けば良い．optionについてはマニュアルを参照．</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ cd /Users/taipapa/Sites/pdf
$ estcmd gather -pc UTF-8 -cl -fx <span style="color:#e6db74">&#34;.pdf&#34;</span> <span style="color:#e6db74">&#34;H@estfxpdftohtml&#34;</span> -il ja -lf -1 -sd -cm -um casket PDFs
</code></pre></div><p>document数が11734個，語数が1351563のindex作成に要した時間は約40分強であった．これは，MacBook Pro (15-inch, Late 2016)でもiMac 2012 でも，ほとんど変わらなかった．</p>
<p>optionとしては，optimizeがインデックスを最適化して、不要な領域を削除，purgeはインデックス内にあってファイルシステム上にない文書の情報を削除する．</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ cd /Users/taipapa/Sites/pdf
$ estcmd optimize /Library/WebServer/Documents/pdf/casket
$ estcmd purge -cl /Library/WebServer/Documents/pdf/casket
</code></pre></div><!-- raw HTML omitted -->
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ cd /Users/taipapa/Sites/pdf
$ estcmd optimize /Users/taipapa/Sites/pdf/casket
$ estcmd purge -cl /Users/taipapa/Sites/pdf/casket
</code></pre></div><h3 id="indexの更新">indexの更新</h3>
<p>前述の3つのコマンドを打てば良い．</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ cd /Users/taipapa/Sites/pdf
$ estcmd gather -pc UTF-8 -cl -fx <span style="color:#e6db74">&#34;.pdf&#34;</span> <span style="color:#e6db74">&#34;H@estfxpdftohtml&#34;</span> -il ja -lf -1 -sd -cm -um casket PDFs
$ estcmd optimize /Library/WebServer/Documents/pdf/casket
$ estcmd purge -cl /Library/WebServer/Documents/pdf/casket
</code></pre></div><!-- raw HTML omitted -->
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ cd /Users/taipapa/Sites/pdf
$ estcmd gather -pc UTF-8 -cl -fx <span style="color:#e6db74">&#34;.pdf&#34;</span> <span style="color:#e6db74">&#34;H@estfxpdftohtml&#34;</span> -il ja -lf -1 -sd -cm -um casket PDFs
$ estcmd optimize /Users/taipapa/Sites/pdf/casket
$ estcmd purge -cl /Users/taipapa/Sites/pdf/casket
</code></pre></div><p>最初にゼロからindexを作成する際は，上記のようにかなり時間がかかるが，一旦作ってしまえば，更新はごく短時間で終了する．更新の自動化については，Amrtaさんの <a href="https://skalldan.wordpress.com/2011/07/01/hyper-estraier-%E3%81%A7-pdf-%E6%96%87%E6%9B%B8%E7%AE%A1%E7%90%86/#sec-3">インデックス更新の自動化</a> を参考にされたい．</p>
<h3 id="検索のテスト">検索のテスト</h3>
<p>試しにterminalで検索してみる．</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ cd /Users/taipapa/Sites/pdf
$ estcmd search -vh casket HSP27
--------<span style="color:#f92672">[</span>02D18ACF711B9586<span style="color:#f92672">]</span>--------
VERSION  1.0
NODE     local
HIT      <span style="color:#ae81ff">288</span>
HINT#1   hsp27   <span style="color:#ae81ff">288</span>
TIME     0.001226
DOCNUM   <span style="color:#ae81ff">11734</span>
WORDNUM  <span style="color:#ae81ff">1354563</span>
VIEW     HUMAN
..........
</code></pre></div><p>うん，ちゃんと動いている．それに速い！</p>
<h2 id="apache-set-up">Apache set up</h2>
<p>terminalで検索ではあまりに寂しいので，ブラウザで検索できるようにするために，Web serverを立ち上げる．MacにはデフォルトでApacheがインストールされているというありがたい状態になっているので，これを使う．なお，Apacheについては，<a href="https://www.kagoya.jp/howto/rentalserver/apache/">Apacheとは？Webサーバーの仕組みと人気サーバーソフトを徹底解説</a>などを参考にされたい．</p>
<p>Apacheの設定については，以下を参考にした．</p>
<ul>
<li>参考1：<a href="https://qiita.com/shuntaro%5Ftamura/items/bdabcb77926dc92617b1">Macでローカルサーバを立ち上げる方法</a></li>
<li>参考2：<a href="https://qiita.com/kid%5Fdrill/items/5c85917068490177b6ab">MacでApacheを立ち上げてみる</a></li>
<li>参考3：<a href="https://qiita.com/YuukiWatanabe/items/f89fe047ace61d2d2b45">Macでローカルサーバー構築あれこれ</a></li>
<li>参考4：<a href="https://httpd.apache.org/docs/2.4/ja/howto/cgi.html">Apache Tutorial: CGI による動的コンテンツ</a>  （結局，きちんと理解する為には，これをはじめとするApacheのチュートリアルを読むのが一番であった）</li>
</ul>
<p>これらのサイトを読んだ方が早いのだが，自分のために設定などをまとめておく．</p>
<p>まず，念のためにApacheが既にインストールされているかどうかを確かめてみる．</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ httpd -v
Server version: Apache/2.4.34 <span style="color:#f92672">(</span>Unix<span style="color:#f92672">)</span>
Server built:   Feb <span style="color:#ae81ff">22</span> <span style="color:#ae81ff">2019</span> 20:20:11
</code></pre></div><p>確かにインストールされている．</p>
<h3 id="cgi-を許可するように-apache-を設定する">CGI を許可するように Apache を設定する</h3>
<ul>
<li>
<p>参照：<a href="https://httpd.apache.org/docs/2.4/ja/howto/cgi.html">Apache Tutorial: CGI による動的コンテンツ</a></p>
</li>
<li>
<p><strong>Apacheの設定ファイルの場所は、/etc/apache2/httpd.conf</strong></p>
</li>
<li>
<p>CGI (Common Gateway Interface) は，ウェブサーバが コンテンツ生成をする外部プログラムと協調して動作するための方法を 定義している．</p>
</li>
<li>
<p>CGI プログラムを正しく動作させるには、CGI を許可するように Apache の設定を行う必要がある．</p>
</li>
<li>
<p>Apache が共有モジュール機能付きでビルドされている場合、モジュールがロードされていることを確認する．具体的には，/etc/apache2/httpd.conf をviを使って以下のように書き換えれば良い（root権限が必要なので sudo している）．</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">sudo vi /etc/apache2/httpd.conf
....
<span style="color:#ae81ff">165</span> <span style="color:#75715e">#LoadModule cgi_module libexec/apache2/mod_cgi.so</span>
-----&gt;
LoadModule cgi_module libexec/apache2/mod_cgi.so
</code></pre></div><p>165行目の行頭の＃を外してアンコメントし，有効化しておく．<!-- raw HTML omitted -->
これをやらないと，cgiが働かず，そのファイル自体がダウンロードされてしまう．</p>
</li>
<li>
<p>設定ファイルの更新内容を反映させるためにはApacheの再起動が必要</p>
</li>
</ul>
<h3 id="apacheの起動-再起動">Apacheの起動，再起動</h3>
<ul>
<li>
<p>Apacheの起動</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ sudo apachectl start
</code></pre></div><ul>
<li>Apacheの停止</li>
</ul>
<!-- raw HTML omitted -->
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ sudo apachectl stop
</code></pre></div><ul>
<li>Apacheの再起動</li>
</ul>
<!-- raw HTML omitted -->
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ sudo apachectl restart
</code></pre></div></li>
</ul>
<p>これでApacheを起動したので，hyperestraierに含まれている検索用CGI scriptを利用する．</p>
<h3 id="cgiが動くかどうかのテスト">CGIが動くかどうかのテスト</h3>
<p><a href="https://httpd.apache.org/docs/2.4/ja/howto/cgi.html">Apache Tutorial: CGI による動的コンテンツ</a> には，「ScriptAlias ディレクティブを使用して、 CGI プログラム用の特別な別ディレクトリを Apache に設定します。 Apache は、このディレクトリ中の全てのファイルを CGI プログラムであると仮定します。 そして、この特別なリソースがクライアントから要求されると、 そのプログラムの実行を試みます。」と記載されている．一方, mojaveのデフォルトの /etc/apache2/httpd.confでは，ScriptAliasではなく，以下のようにScriptAliasMatchを用いている．</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#ae81ff">373</span>  ScriptAliasMatch ^/cgi-bin/<span style="color:#f92672">(</span><span style="color:#f92672">(</span>?!<span style="color:#f92672">(</span>?i:webobjects<span style="color:#f92672">)</span><span style="color:#f92672">)</span>.*$<span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">/Library/WebServer/CGI-Executables/</span>$1<span style="color:#e6db74">&#34;</span>
</code></pre></div><p>この正規表現の記述により，cgi-bin/というパスが/Library/WebServer/CGI-Executables/に対応するようになっている（詳細は，<a href="http://httpd.apache.org/docs/2.4/mod/mod%5Falias.html#scriptalias">ScriptAlias ディレクティブ</a>  のScriptAliasMatch ディレクティブを参照）</p>
<p>ということで，/Library/WebServer/CGI-Executables/にcgi scriptを置けば，CGI programとして動くはずである．macでは最初からperlがインストールされているので，以下のようなperl script（&ldquo;Hello&quot;と表示するだけ）を作成して試してみる．</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-perl" data-lang="perl"><span style="color:#75715e">#!/usr/bin/perl</span>
<span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;Content-type: text/html \n\n&#34;</span>;
<span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;Hello&#34;</span>;
</code></pre></div><p>これを，test.cgiとして保存し，</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ chomod <span style="color:#ae81ff">755</span> test.cgi
</code></pre></div><p>して，実行権限を付与した上で，/Library/WebServer/CGI-Executables/に置く．この状態で，ブラウザのurl windowに localhost/cgi-bin/test.cgi と打ち込むと，&ldquo;Hello&rdquo; と表示される．</p>
<p>さて，次の段階に進む前にDocumentRootについて，ちょっと説明が必要（後日の自分のため）．</p>
<h3 id="documentroot">DocumentRoot</h3>
<ul>
<li>参考：<a href="https://www.adminweb.jp/apache/docroot/index1.html">ドキュメントルート(DocumentRoot)</a></li>
</ul>
<p>/etc/apache2/httpd.confを，lessを使って読んでみると以下のように書かれている．</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ less -N /etc/apache2/httpd.conf
..........
<span style="color:#ae81ff">240</span> #
<span style="color:#ae81ff">241</span> <span style="color:#75715e"># DocumentRoot: The directory out of which you will serve your</span>
<span style="color:#ae81ff">242</span> <span style="color:#75715e"># documents. By default, all requests are taken from this directory, but</span>
<span style="color:#ae81ff">243</span> <span style="color:#75715e"># symbolic links and aliases may be used to point to other locations.</span>
<span style="color:#ae81ff">244</span> #
<span style="color:#ae81ff">245</span> DocumentRoot <span style="color:#e6db74">&#34;/Library/WebServer/Documents&#34;</span>
<span style="color:#ae81ff">246</span> &lt;Directory <span style="color:#e6db74">&#34;/Library/WebServer/Documents&#34;</span>&gt;
..........
</code></pre></div><p>要するにDocumentRootというのは文書やコンテンツの置き場所として使われるディレクトリである．Macの場合は， <strong>DocumentRoot &ldquo;/Library/WebServer/Documents&rdquo;</strong> と指定されており，WWW serverとして公開する内容は，/Library/WebServer/Documents 以下に配置していくことになる．他の場所を参照するためにシンボリックリンクやエーリアスを使用しても良いと書かれている．</p>
<p>先ほど起動したApacheへブラウザからアクセスすると（ブラウザのurl が表示されているところにlocalhostと打てば良い）以下のような画面が表示される．</p>






<figure>

  <a data-fancybox="" href="/img/Apache.jpg" >

<img src="/img/Apache.jpg" width="80%" >
</a>

</figure>

<p>これは，/Library/WebServer/Documents/index.html.en が表示されているのである．</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ less /Library/WebServer/Documents/index.html.en
&lt;html&gt;&lt;body&gt;&lt;h1&gt;It works!&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;
/Library/WebServer/Documents/index.html.en <span style="color:#f92672">(</span>END<span style="color:#f92672">)</span>
</code></pre></div><p>つまり，この  /Library/WebServer/Documents ディレクトリの配下が， <a href="http://localhost">http://localhost</a> のroot直下となる．pdfを含むディレクトリ，あるいはそのシンボリックリンクを/Library/WebServer/Documents ディレクトリの配下に置けば全文検索を行うcgi scriptの対象とできるわけである．</p>
<p>しかし，そうなると，前述の/Library/WebServer/CGI-Executables/に於いても同じであるが，全ての作業をrootとして行わなければならなくなり，何をするにもsudoしないといけないのが面倒であるし，security上でも問題であろう．そこで，UserDir ディレクティブを使って 各ユーザがホームディレクトリにSites directoryを作成し，ウェブサイトを構築できるように設定する．要するに，先ほど作成した/Users/taipapa/Sites/pdf/以下のディレクトリで全文検索ができるように設定するということである．</p>
<h3 id="ユーザ毎のウェブディレクトリ">ユーザ毎のウェブディレクトリ</h3>
<ul>
<li>参照1：<a href="http://motw.mods.jp/Mac/local%5Fserver.html">apacheを使ってローカルサーバーを構築する方法</a></li>
<li>参照2：<a href="http://neos21.hatenablog.com/entry/2019/01/27/080000">MacOS 同梱の Apache が参照するドキュメントルートを変更する</a></li>
<li>参照3：<a href="https://qiita.com/colorrabbit/items/3ab4c2d863a55ca72d35">MacOS X の Yosemite (10.10) で Sites ディレクトリを使って localhost をアカウント別に利用する方法</a></li>
<li>参照4：<a href="https://httpd.apache.org/docs/2.4/ja/howto/public%5Fhtml.html">ユーザ毎のウェブディレクトリ</a></li>
</ul>
<p>やはりApacheのチュートリアル（<a href="https://httpd.apache.org/docs/2.4/ja/howto/public%5Fhtml.html">ユーザ毎のウェブディレクトリ</a>）を読むのが一番分かりやすかった．以下はこのサイトからの引用</p>
<ul>
<li>「複数のユーザのいるシステムでは、UserDir ディレクティブを使って 各ユーザがホームディレクトリにウェブサイトを構築できるように設定することが 可能です。URL <a href="http://example.com/~username/">http://example.com/~username/</a> を訪れた人は &ldquo;username&rdquo; というユーザの UserDir ディレクティブで指定された サブディレクトリからコンテンツを得ることになります。」</li>
<li>「デフォルトではこれらのディレクトリへのアクセスは許可されていません。 UserDir を使って有効にできます。 有効にするには、デフォルトの設定ファイルで付随する httpd-userdir.conf ファイルが必要」という翻訳になっている．意味はなんとなくわかるが，後半部分は「デフォルトの設定ファイルであるhttpd-userdir.conf ファイルの中の次の行をアンコメントすることによりアクセスが可能となる．また，必要に応じてhttpd-userdir.confも適切に変更する」と訳すべきと思う．</li>
</ul>
<h4 id="httpd-userdir-dot-confの有効化">httpd-userdir.confの有効化</h4>
<p>手順としては，まず，/etc/apache2/httpd.confの511行目の行頭の#を外し，コメントアウトを外してhttpd-userdir.confを有効にする．</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ sudo vi /etc/apache2/httpd.conf
..........
<span style="color:#ae81ff">510</span> <span style="color:#75715e"># User home directories</span>
<span style="color:#ae81ff">511</span> <span style="color:#75715e">#Include /private/etc/apache2/extra/httpd-userdir.conf</span>
-----&gt;
<span style="color:#ae81ff">511</span> Include /private/etc/apache2/extra/httpd-userdir.conf
..........
</code></pre></div><h4 id="httpd-userdir-dot-confの編集-ユーザー毎の設定ファイルを読み込む様にする">httpd-userdir.confの編集（ユーザー毎の設定ファイルを読み込む様にする）</h4>
<p>ついで，有効にした /etc/apache2/extra/httpd-userdir.confを見て，編集する．</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ sudo vi /etc/apache2/extra/httpd-userdir.conf

<span style="color:#ae81ff">1</span> <span style="color:#75715e"># Settings for user home directories</span>
<span style="color:#ae81ff">2</span> #
<span style="color:#ae81ff">3</span> <span style="color:#75715e"># Required module: mod_authz_core, mod_authz_host, mod_userdir</span>
<span style="color:#ae81ff">4</span>
<span style="color:#ae81ff">5</span> #
<span style="color:#ae81ff">6</span> <span style="color:#75715e"># UserDir: The name of the directory that is appended onto a user&#39;s home</span>
<span style="color:#ae81ff">7</span> <span style="color:#75715e"># directory if a ~user request is received.  Note that you must also set</span>
<span style="color:#ae81ff">8</span> <span style="color:#75715e"># the default access control for these directories, as in the example below.</span>
<span style="color:#ae81ff">9</span> #
<span style="color:#ae81ff">10</span> UserDir Sites
<span style="color:#ae81ff">11</span>
<span style="color:#ae81ff">12</span> #
<span style="color:#ae81ff">13</span> <span style="color:#75715e"># Control access to UserDir directories.  The following is an example</span>
<span style="color:#ae81ff">14</span> <span style="color:#75715e"># for a site where these directories are restricted to read-only.</span>
<span style="color:#ae81ff">15</span> #
<span style="color:#ae81ff">16</span> <span style="color:#75715e"># Include /private/etc/apache2/users/*.conf</span>
<span style="color:#ae81ff">17</span> &lt;IfModule bonjour_module&gt;
<span style="color:#ae81ff">18</span>        RegisterUserSite customized-users
<span style="color:#ae81ff">19</span> &lt;/IfModule&gt;
</code></pre></div><p>10行目の&quot;UserDir Sites&quot;は デフォルトでアンコメントされており，そのままで良い．これにより，~usernameでSites directoryにアクセスできるようになる．編集する部分は，16行目の &quot; # Include /private/etc/apache2/users/*.conf&rdquo; であり，行頭の＃を外してアンコメントし，有効化しておく．これによりユーザーごとの設定ファイルを読み込む様になる（<a href="https://qiita.com/colorrabbit/items/3ab4c2d863a55ca72d35">MacOS X の Yosemite (10.10) で Sites ディレクトリを使って localhost をアカウント別に利用する方法</a>）．</p>
<p>また，3行目にあるように，ユーザーのホームディレクトリのセットアップのために， <strong>mod_authz_core, mod_authz_host, mod_userdirを全て有効</strong> にしておく必要がある．以下のように， <strong>/etc/apache2/httpd.conf</strong> を編集する．</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">sudo vi /etc/apache2/httpd.conf
......
<span style="color:#ae81ff">77</span> LoadModule authz_host_module libexec/apache2/mod_authz_host.so
<span style="color:#ae81ff">78</span> LoadModule authz_groupfile_module libexec/apache2/mod_authz_groupfile.so
<span style="color:#ae81ff">79</span> LoadModule authz_user_module libexec/apache2/mod_authz_user.so
<span style="color:#ae81ff">80</span> <span style="color:#75715e">#LoadModule authz_dbm_module libexec/apache2/mod_authz_dbm.so</span>
<span style="color:#ae81ff">81</span> <span style="color:#75715e">#LoadModule authz_owner_module libexec/apache2/mod_authz_owner.so</span>
<span style="color:#ae81ff">82</span> <span style="color:#75715e">#LoadModule authz_dbd_module libexec/apache2/mod_authz_dbd.so</span>
<span style="color:#ae81ff">83</span> LoadModule authz_core_module libexec/apache2/mod_authz_core.so
......
<span style="color:#ae81ff">173</span> <span style="color:#75715e">#LoadModule speling_module libexec/apache2/mod_speling.so</span>
<span style="color:#ae81ff">174</span> <span style="color:#75715e">#LoadModule userdir_module libexec/apache2/mod_userdir.so</span>
<span style="color:#ae81ff">175</span> LoadModule alias_module libexec/apache2/mod_alias.so
...
</code></pre></div><p>77行目の &ldquo;LoadModule authz_host_module libexec/apache2/mod_authz_host.so&rdquo; と83行目の &ldquo;LoadModule authz_core_module libexec/apache2/mod_authz_core.so&quot;はデフォルトでアンコメントされていたが，174行目の &ldquo;#LoadModule userdir_module libexec/apache2/mod_userdir.so&rdquo; はコメントアウトされていたので，#を外して有効化した．これらの設定で， <strong>ユーザーディレクトリが有効</strong> になる．</p>
<h4 id="ユーザー毎の設定ファイルを作成">ユーザー毎の設定ファイルを作成</h4>
<p>自分の使っているusernameを知らない人はいないと思うが，万一分からなければ以下のコマンドを使う．</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ whoami
taipapa
</code></pre></div><p>ついで，/etc/apache2/users にユーザー毎の設定ファイルを作成する．今回はtaipapaの設定ファイルということになる．</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ sudo vi /etc/apache2/users/taipapa.conf

&lt;Directory <span style="color:#e6db74">&#34;/Users/taipapa/Sites/&#34;</span>&gt;
AddHandler cgi-script cgi
AllowOverride All
Options Indexes FollowSymLinks Multiviews ExecCGI
Require all granted
&lt;/Directory&gt;
</code></pre></div><p>内容を簡単に説明する．</p>
<ul>
<li>Directory (<a href="https://httpd.apache.org/docs/2.4/ja/mod/core.html#directory">Directory ディレクティブ</a>): 指定されたディレクトリとそのサブディレクトリにのみ ディレクティブを適用させるためには、 Directory と /Directory を対として、ディレクティブ群を囲む．以下はディレクティブの説明</li>
<li>AddHandler (<a href="https://httpd.apache.org/docs/2.4/ja/mod/mod%5Fmime.html#addhandler">AddHandler ディレクティブ</a> ): ファイル名の拡張子を指定されたハンドラにマップする．&ldquo;AddHandler cgi-script cgi&rdquo; により，/Users/taipapa/Sites/の配下にある拡張子 &ldquo;.&rdquo; で終わるファイルを CGI スクリプトとして扱うようになる．</li>
<li>AllowOverride (<a href="https://httpd.apache.org/docs/2.4/ja/mod/core.html#allowoverride">AllowOverride ディレクティブ</a>): このディレクティブが All に設定されている時には、 .htaccess という コンテキスト を持つ 全てのディレクティブが利用できる．</li>
<li>Options (<a href="https://httpd.apache.org/docs/2.4/ja/mod/core.html#options">Options ディレクティブ</a>): ディレクトリに対して使用可能な機能を設定する．個々の機能はリンク先を参照．今回重要なのは， <strong>ExecCGI</strong> で，これはmod_cgiによるCGI scriptの実行を許可する．</li>
<li>Require (参照：<a href="https://qiita.com/100/items/ab31e57fcc66ac661d5c">Apache 2.4 設定ファイルの記述例</a>): サーバーのディレクトリに接続してくるクライアントについて、許可・拒否する条件を指定するディレクティブ．昔はAllow ディレクティブやDeny ディレクティブを利用していた． <strong>&ldquo;Require all granted&rdquo; は、すべてのクライアントからの接続を許可する．</strong> &ldquo;Require all denied&rdquo; は、すべてのクライアントからの接続を拒否する．</li>
</ul>
<p>これで，Apache関連の設定が終了した．次はいよいよCGI scriptの設定である．</p>
<h2 id="hyperestraier付属の全文検索用cgi-scriptのset-up">Hyperestraier付属の全文検索用CGI scriptのset up</h2>
<p>ようやく，ブラウザによる全文検索ができるようにするためにCGI scriptのset upをするところまでたどり着いた．hyperestraierに含まれている検索用CGI scriptは，<a href="https://fallabs.com/hyperestraier/uguide-ja.html#estseek">estseek.cgi</a>である．詳細はリンク先のマニュアルを参照していただきたい．そこにはこうある．「estseek.cgiが動作するには、設定ファイルとテンプレートファイルとトップページファイルとヘルプファイルが必要です。それぞれestseek.conf、estseek.tmpl、estseek.top、estseek.helpというのが標準的な名前です。」これらのscriptおよび関連ファイルは，brewでインストールした場合は，以下のような場所に入る．</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ mdfind -name estseek
/usr/local/Cellar/hyperestraier/1.4.13/libexec/estseek.cgi
/usr/local/Cellar/hyperestraier/1.4.13/share/hyperestraier/locale/ja/estseek.top
/usr/local/Cellar/hyperestraier/1.4.13/share/hyperestraier/locale/ja/estseek.tmpl
/usr/local/Cellar/hyperestraier/1.4.13/share/hyperestraier/locale/ja/estseek.help
/usr/local/Cellar/hyperestraier/1.4.13/share/hyperestraier/locale/ja/estseek.conf
/usr/local/Cellar/hyperestraier/1.4.13/share/hyperestraier/increm/estseek-frame.html
/usr/local/Cellar/hyperestraier/1.4.13/share/hyperestraier/increm/estseek-form.html
/usr/local/Cellar/hyperestraier/1.4.13/share/hyperestraier/estseek.top
/usr/local/Cellar/hyperestraier/1.4.13/share/hyperestraier/estseek.tmpl
/usr/local/Cellar/hyperestraier/1.4.13/share/hyperestraier/estseek.help
/usr/local/Cellar/hyperestraier/1.4.13/share/hyperestraier/estseek.conf

$ ls /usr/local/Cellar/hyperestraier/1.4.13/libexec/
estfraud.cgi* estproxy.cgi* estscout.cgi* estseek.cgi*  estsupt.cgi*

$ ls /usr/local/Cellar/hyperestraier/1.4.13/share/hyperestraier/
COPYING        estfraud.conf  estscout.conf  estseek.top    locale/
ChangeLog      estproxy.conf  estseek.conf   estsupt.conf
THANKS         estraier.idl   estseek.help   filter/
doc/           estresult.dtd  estseek.tmpl   increm/
</code></pre></div><p>そこで，これらのscriptをユーザーディレクトリのしかるべき場所にコピーする．今回は，まず，前半部で作成した/Users/taipapa/Sitesにcgi-bin というディレクトリを作成し，CGI scriptの置き場所とした．そして，その配下にestというディレクトリを作って，そこにhyperestraierによる全文検索用のscript などをコピーした．</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ cd /Users/taipapa/Sites
$ mkdir -p cgi-bin/est
$ tree -L <span style="color:#ae81ff">2</span>
.
├── cgi-bin
│   ├── est
│   └── test.cgi
├── index.html
├── pdf
│   ├── PDFs
│   └── casket
└── test.cgi
$ cd cgi-bin/est
$ cp -a /usr/local/Cellar/hyperestraier/1.4.13/libexec/* .
$ cp -a /usr/local/Cellar/hyperestraier/1.4.13/share/hyperestraier/est* .
$ ls
estfraud.cgi*  estproxy.conf  estscout.cgi*  estseek.conf   estseek.top
estfraud.conf  estraier.idl   estscout.conf  estseek.help   estsupt.cgi*
estproxy.cgi*  estresult.dtd  estseek.cgi*   estseek.tmpl   estsupt.conf
</code></pre></div><p>設定ファイルであるestseek.confはdefaultでは以下のようになっている．</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ cd /Users/taipapa/Sites/cgi-bin/est
$ less -N estseek.conf
..........
<span style="color:#ae81ff">1</span> indexname: casket
<span style="color:#ae81ff">2</span>
<span style="color:#ae81ff">3</span> tmplfile: estseek.tmpl
<span style="color:#ae81ff">4</span>
<span style="color:#ae81ff">5</span> topfile: estseek.top
<span style="color:#ae81ff">6</span>
<span style="color:#ae81ff">7</span> helpfile: estseek.help
<span style="color:#ae81ff">8</span>
<span style="color:#ae81ff">9</span> lockindex: true
<span style="color:#ae81ff">10</span>
<span style="color:#ae81ff">11</span> pseudoindex:
<span style="color:#ae81ff">12</span>
<span style="color:#ae81ff">13</span> replace: ^file:///home/mikio/public_html/<span style="color:#f92672">{</span><span style="color:#f92672">{</span>!<span style="color:#f92672">}</span><span style="color:#f92672">}</span>http://localhost/
<span style="color:#ae81ff">14</span> replace: /index<span style="color:#ae81ff">\.</span>html?<span style="color:#e6db74">${</span>{!<span style="color:#e6db74">}</span><span style="color:#f92672">}</span>/
<span style="color:#ae81ff">15</span>
<span style="color:#ae81ff">16</span> showlreal: false
..........
</code></pre></div><p>これを以下のように編集する．</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#ae81ff">1</span> <span style="color:#75715e">#indexname: casket</span>
<span style="color:#ae81ff">2</span> indexname: /Users/taipapa/Sites/pdf/casket
<span style="color:#ae81ff">3</span>
<span style="color:#ae81ff">4</span> tmplfile: estseek.tmpl
<span style="color:#ae81ff">5</span>
<span style="color:#ae81ff">6</span> topfile: estseek.top
<span style="color:#ae81ff">7</span>
<span style="color:#ae81ff">8</span> helpfile: estseek.help
<span style="color:#ae81ff">9</span>
<span style="color:#ae81ff">10</span> lockindex: true
<span style="color:#ae81ff">11</span>
<span style="color:#ae81ff">12</span> pseudoindex:
<span style="color:#ae81ff">13</span>
<span style="color:#ae81ff">14</span> <span style="color:#75715e">#replace: ^file:///home/mikio/public_html/{{!}}http://localhost/</span>
<span style="color:#ae81ff">15</span> <span style="color:#75715e">#replace: /index\.html?${{!}}/</span>
<span style="color:#ae81ff">16</span>
<span style="color:#ae81ff">17</span> replace: ^file:///Data/<span style="color:#f92672">{</span><span style="color:#f92672">{</span>!<span style="color:#f92672">}</span><span style="color:#f92672">}</span>http://localhost/~taipapa/pdf/PDFs/
<span style="color:#ae81ff">18</span>
</code></pre></div><p>17行目の <strong>replace:</strong> の部分はかなりの試行錯誤が必要であった．マニュアルでは，「replaceは正規表現によってURIを変換するのに使います。複数回指定できます。先頭にマッチする「^」を駆使すれば接頭辞（ディレクトリ）の変換ができますし、末尾にマッチする「$」を駆使すれば接尾辞（拡張子）の変換ができます。」とあるように，どこにpdf文書を置くかで適切に変更する必要がある．私の場合は，前述のごとく，pdfのあるディレクトリが，/Data/hogehoge, /Data/fugaguga, /Data/misc で，/Users/taipapa/Sites/pdf/PDFs にシンボリックリンクで集約したので，このような設定になった．他のファイルはdefaultのままとした．</p>
<p>これで，全ての準備は整った．Sites ディレクトリには前半部で説明した通り，pdf archiveへのシンボリックリンクが集約されており，かつ，全文検索用の索引であるcasketも置いてある．全てが正しく設定されていれば，ブラウザのurl windowに <strong><a href="http://localhost/~username/cgi-bin/est/estseek.cgi">http://localhost/~username/cgi-bin/est/estseek.cgi</a></strong> （今回は~usernameは~taipapa） と打ち込むと，以下のような全文検索の画面になるはずである．</p>






<figure>

  <a data-fancybox="" href="/img/FTsearch_view.jpg" >

<img src="/img/FTsearch_view.jpg" width="80%" >
</a>

</figure>

<p>早速検索してみよう．HSP27と入れてみると，結果は以下の通り．検索に用いたキーワードが黄色でハイライトされている．</p>






<figure>

  <a data-fancybox="" href="/img/FTsearch_view2.jpg" >

<img src="/img/FTsearch_view2.jpg" width="80%" >
</a>

</figure>

<p>一番最初の2667.full.pdfを右クリックすると，下のように別タブでpdfが開く．</p>






<figure>

  <a data-fancybox="" href="/img/FTsearch_view3.jpg" >

<img src="/img/FTsearch_view3.jpg" width="80%" >
</a>

</figure>

<p>また，各結果の[detail]の部分を右クリックすると以下のような画面が別タブで開く．</p>






<figure>

  <a data-fancybox="" href="/img/FTsearch_view4.jpg" >

<img src="/img/FTsearch_view4.jpg" width="80%" >
</a>

</figure>

<p>これは，pdfの内容をテキストで出力したものである．一見，見にくくて何の役にたつと思うかもしれないが，検索キーワードが黄色にハイライトされており，この単語の使い方が一目でわかるようになっている．論文を書くときに参考になる．</p>
<p>この全文検索を使い始めてもう5-6年になるが，一旦セットアップしてしまえば，時々indexを更新する以外は手間いらずで，重宝している．更新の自動化については，前述の通り．</p>
<p>今回は，このブログを始めて以来の長文になってしまった．後日の自分のためにできるだけ細かいところまで書き留めておいた．半分以上はApacheの設定に関する記述になっている（笑）．</p>
    </div>

    


    

<div class="article-tags">
  
  <a class="badge badge-light" href="/tags/macos/">macos</a>
  
  <a class="badge badge-light" href="/tags/mojave/">mojave</a>
  
  <a class="badge badge-light" href="/tags/full-text-search/">full-text-search</a>
  
  <a class="badge badge-light" href="/tags/hyperestraier/">hyperestraier</a>
  
  <a class="badge badge-light" href="/tags/pdf/">pdf</a>
  
</div>



    
      








  





  
  
  
    
  
  
  <div class="media author-card" itemscope itemtype="http://schema.org/Person">
    
      
      <img class="portrait mr-3" src="/authors/admin/avatar%20%28Copy%201%29_hu0e0eac0269c34ce41ed30e928150bd75_369085_250x250_fill_q90_lanczos_center.jpg" itemprop="image" alt="Avatar">
    

    <div class="media-body">
      <h5 class="card-title" itemprop="name"><a href="/">taipapa</a></h5>
      <h6 class="card-subtitle">本人ではありません　(^^)</h6>
      
      <ul class="network-icon" aria-hidden="true">
        
          
          
          
            
          
          
          
          
          
          <li>
            <a itemprop="sameAs" href="mailto:taipapamotohus@gmail.com" >
              <i class="fas fa-envelope"></i>
            </a>
          </li>
        
          
          
          
          
          
          
          
            
          
          <li>
            <a itemprop="sameAs" href="https://scholar.google.com/citations?user=x1m6M2IAAAAJ&amp;hl=en" target="_blank" rel="noopener">
              <i class="ai ai-google-scholar"></i>
            </a>
          </li>
        
          
          
          
            
          
          
          
          
          
            
          
          <li>
            <a itemprop="sameAs" href="https://github.com/taipapamotohus" target="_blank" rel="noopener">
              <i class="fab fa-github"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>



      
      
      <div class="article-widget">
        <div class="hr-light"></div>
        <h3>Related</h3>
        <ul>
          
          <li><a href="/post/live/">mojaveのライブ変換で快適日本語入力（カーソルの色も日英で変わるように設定）</a></li>
          
          <li><a href="/post/pdf-tools/">Emacsでpdfを読む (pdf-tools) (2019.07.17追記)</a></li>
          
          <li><a href="/post/synchronization/">Emacsとskimで，latexのソースとpdfの間を行ったり来たり</a></li>
          
          <li><a href="/post/org-mode_paper_2/">Emacsのorg-modeで論文を書く（その2：BibDeskによる論文収集と整理）</a></li>
          
          <li><a href="/post/beamer_movie2/">beamerでスライド原稿用pdfを作成する（その3）動画が走るスライド原稿を作る（media9に関する追記）</a></li>
          
        </ul>
      </div>
      
    

    
    <div class="article-widget">
      
<div class="post-nav">
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Next</div>
    <a href="/post/how-to-upgrade-hugo-and-academic-theme/" rel="next">How to update hugo and academic theme (Part 1)</a>
  </div>
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Previous</div>
    <a href="/post/pdf-tools/" rel="prev">Emacsでpdfを読む (pdf-tools) (2019.07.17追記)</a>
  </div>
  
</div>

    </div>
    

    
<section id="comments">
  
    
<div id="disqus_thread"></div>
<script>
  let disqus_config = function () {
    
    
    
  };
  (function() {
    if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
      document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
      return;
    }
    var d = document, s = d.createElement('script'); s.async = true;
    s.src = 'https://' + "a-perfect-autumn-day" + '.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


  
</section>



  </div>
</article>

      

    
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js" integrity="sha256-aYTdUrn6Ow1DDgh5JTc3aDGnnju48y/1c8s1dgkYPQ8=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/go.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/lisp.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/ocaml.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/sh.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/tex.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/r.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/emacs-lisp.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/pearl.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/python.min.js"></script>
        
      

      
      
    

    
    

    
    
    <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script>
      const search_index_filename = "/index.json";
      const i18n = {
        'placeholder': "Search...",
        'results': "results found",
        'no_results': "No results found"
      };
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    
    <script id="dsq-count-scr" src="https://a-perfect-autumn-day.disqus.com/count.js" async></script>
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.16bbb3750feb7244c9bc409a5a4fe678.js"></script>

    






  
  <div class="container">
    <footer class="site-footer">
  
  <p class="powered-by">
    
      <a href="/privacy/">Privacy Policy</a>
    
    
       &middot; 
      <a href="/terms/">Terms</a>
        
  </p>
  

  <p class="powered-by">
    © 2020 &middot; 

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" id="back_to_top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
