<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>reference | A perfect autumn day</title>
    <link>/tags/reference/</link>
      <atom:link href="/tags/reference/index.xml" rel="self" type="application/rss+xml" />
    <description>reference</description>
    <generator>Source Themes Academic (https://sourcethemes.com/academic/)</generator><language>en-us</language><copyright>© 2020</copyright><lastBuildDate>Mon, 17 Sep 2018 00:00:00 +0900</lastBuildDate>
    <image>
      <url>/img/icon-192.png</url>
      <title>reference</title>
      <link>/tags/reference/</link>
    </image>
    
    <item>
      <title>Emacsのorg-modeで論文を書く（その4：pandocを利用してorg-modeからword [docx]を文献付きでexportする）</title>
      <link>/post/org-mode_paper_4/</link>
      <pubDate>Mon, 17 Sep 2018 00:00:00 +0900</pubDate>
      <guid>/post/org-mode_paper_4/</guid>
      <description>&lt;p&gt;医学系の多くのジャーナルでは，論文投稿の際のフォーマットを Microsoft Word と指定しているところが多い．．．．．&lt;/p&gt;
&lt;p&gt;いま，一瞬，憤りのあまり意識を失いかけたが，気を取り直して続ける．実際のところ，仕事でもしばしばword文書を要求される．イチからwordで文書を書くのはやりたくないわけで，ふと，org-modeからexportできないかと調べてみた．やはり，同じようなことを考える人はいるもので，エライ人はそれを実現させるべく色々な方法を開発していた．それらの中から，自分で試してみてうまく行った方法をまとめておく．使用するのは， &lt;strong&gt;pandoc&lt;/strong&gt; とそれをorg−modeから利用するための &lt;strong&gt;ox-pandoc&lt;/strong&gt; である．&lt;/p&gt;
&lt;h2&gt;Table of Contents&lt;/h2&gt;

&lt;h2 id=&#34;ox-pandoc&#34;&gt;ox-pandoc&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;参照サイト1：本家　&lt;a href=&#34;https://github.com/kawabata/ox-pandoc&#34;&gt;ox-pandoc&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;参照サイト2：&lt;a href=&#34;http://kitchingroup.cheme.cmu.edu/blog/2015/06/11/ox-pandoc-org-mode-+-org-ref-to-docx-with-bibliographies/&#34;&gt;ox-pandoc - org-mode + org-ref to docx with bibliographies&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;参照サイト3：もっと本家　&lt;a href=&#34;https://pandoc.org&#34;&gt;Pandoc   a universal document converter&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;pandoc自体の説明は略．ご存知，フォーマット変換のスイスアーミーナイフ．&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ox-pandocは，pandocを介してorg-mode fileを様々なフォーマットに変換する新しいexporterであり，40種ものフォーマットに変換できる．&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;pandoc 2.0 (or later version)と，bibliography featureを使うならpandoc-citeproc 0.3 (or later)が必要なので，homebrewでインストールする．&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;$  brew install pandoc
$  brew install pandoc-citeproc
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;init.orgには以下のように書き込んで，ox-pandocをインストールし，設定する．use-packageを使うと両方がいっぺんにできて便利である．&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-lisp&#34; data-lang=&#34;lisp&#34;&gt;&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;begin_src emacs-lisp
(&lt;span style=&#34;color:#a6e22e&#34;&gt;use-package&lt;/span&gt; ox-pandoc
  &lt;span style=&#34;color:#e6db74&#34;&gt;:ensure&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;t&lt;/span&gt;
  &lt;span style=&#34;color:#e6db74&#34;&gt;:config&lt;/span&gt;
  &lt;span style=&#34;color:#75715e&#34;&gt;;; default options for all output formats&lt;/span&gt;
  (&lt;span style=&#34;color:#66d9ef&#34;&gt;setq&lt;/span&gt; org-pandoc-options &lt;span style=&#34;color:#f92672&#34;&gt;&amp;#39;&lt;/span&gt;((standalone &lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;t&lt;/span&gt;)))
  &lt;span style=&#34;color:#75715e&#34;&gt;;; cancel above settings only for &amp;#39;docx&amp;#39; format&lt;/span&gt;
  (&lt;span style=&#34;color:#66d9ef&#34;&gt;setq&lt;/span&gt; org-pandoc-options-for-docx &lt;span style=&#34;color:#f92672&#34;&gt;&amp;#39;&lt;/span&gt;((standalone &lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;nil&lt;/span&gt;)))
  &lt;span style=&#34;color:#75715e&#34;&gt;;; special settings for beamer-pdf and latex-pdf exporters&lt;/span&gt;
  (&lt;span style=&#34;color:#66d9ef&#34;&gt;setq&lt;/span&gt; org-pandoc-options-for-beamer-pdf &lt;span style=&#34;color:#f92672&#34;&gt;&amp;#39;&lt;/span&gt;((pdf-engine &lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;xelatex&amp;#34;&lt;/span&gt;)))
  (&lt;span style=&#34;color:#66d9ef&#34;&gt;setq&lt;/span&gt; org-pandoc-options-for-latex-pdf &lt;span style=&#34;color:#f92672&#34;&gt;&amp;#39;&lt;/span&gt;((pdf-engine &lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;xelatex&amp;#34;&lt;/span&gt;)))
  )
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;end_src
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;latex engineにxelatex以外を使っている場合は，上記の設定をそちらに変更する．&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;以上でorg-mode自体の基本的な設定は終了である．&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;文書の中で実際に引用された論文のみからなる文献リストを生成する方法&#34;&gt;文書の中で実際に引用された論文のみからなる文献リストを生成する方法&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;このリスト（bib ファイル）を作成しておかないと，Wordをexportする際にうまくいかない．&lt;/li&gt;
&lt;li&gt;reftex-create-bibtex-fileとbibexportの２つの方法がある．&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;reftex-create-bibtex-file&#34;&gt;reftex-create-bibtex-file&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;参照サイト：&lt;a href=&#34;https://www.gnu.org/software/emacs/manual/html%5Fnode/reftex/BibTeX-Database-Subsets.html&#34;&gt;reftex-create-bibtex-file&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Emacsの中に最初から入っているコマンドである．&lt;/li&gt;
&lt;li&gt;前回の記事（&lt;a href=&#34;../org-mode_paper_3&#34;&gt;Emacsのorg-modeで論文を書く（その3：org-modeとbibtexとreftexの連携による文献引用の自動化&lt;/a&gt;）の際に作成したhogefuga.orgからpdfをexportした際に同じdirectory内にhogefuga.texも保存されているはずである．これをEmacsでオープンし, &lt;strong&gt;M-x reftex-create-bibtex-file&lt;/strong&gt; と打つ．すると，実際に引用された論文のみからなる文献リストを生成してくれる．この際に名前をどうするかを聞かれるので，適当につける．今回は，extract.bibとした．&lt;/li&gt;
&lt;li&gt;しかし，たまに，reftex-create-bibtex-fileで引用された論文の一部が欠けてしまうことがある．そのようなときは，第２の方法であるbibexportが役に立つ．&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;bibexport&#34;&gt;bibexport&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;参考サイト1：&lt;a href=&#34;https://ctan.org/pkg/bibexport&#34;&gt;bibexport – Extract a BibTEX file based on a .aux file&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;参考サイト2：&lt;a href=&#34;https://tex.stackexchange.com/questions/41821/creating-bib-file-containing-only-the-cited-references-of-a-bigger-bib-file&#34;&gt;Creating .bib file containing only the cited references of a bigger .bib file&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;texliveに含まれているshell script&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;文書の中の &lt;strong&gt;\cite&lt;/strong&gt; で引用された文献のみを抽出する．上記のreftex-create-bibtex-fileはtex ファイルが有れば抽出できたが，こちらはaux ファイルを必要とする．したがって，まず，org-modeからpdfをexportし，tex ファイルを作成し，次いで，tex ファイルをlatex でコンパイルしてaux ファイルを作成し，そのaux ファイルに対してbibexportを用いるというややこしいことをする必要がある．&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;しかし，reftex-create-bibtex-fileでうまく抽出できないときも，bibexportならうまくいくことが多いので，知っておいて損はない．&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;使い方は以下を参考&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;bibexport --help
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;bibexport: a tool to extract BibTeX entries out of .bib files.
usage: bibexport &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;-h|v|n|c|a|d|s|t&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;-b|e|es|ec|o|r file&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; file...

Basic options:
--------------
 -a, --all                  export the entire .bib files
 -o bib, --output-file bib  write output to file       &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;default: bibexport.bib&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;
 -t, --terse                operate silently
 -h, --help                 print this message and exit
 -v, --version              print version number and exit

Advanced options:
-----------------
 -b bst, --bst bst          specifies the .bst style file &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;default: export.bst&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;
 -c, --crossref             preserve crossref field               &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;default: no&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;
 -n, --no-crossref          remove crossref&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;d entries             [default: no]
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; -e bib, --extra bib        extra .bib file to be used (crossrefs and strings)
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; -es bib, --extras bib      extra .bib file to be used (for strings)
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; -ec bib, --extrac bib      extra .bib file to be used (for crossrefs)
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; -p, --preamble             write a preamble at beginning of output
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; -r bib, --replace bib      replace .bib file(s) in the .aux file
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; -d, --debug                create intermediate files but don&amp;#39;&lt;/span&gt;t run BibTeX
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;例えばこんなふうにshellで打つ&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;$ bibexport -o extract2.bib hogefuga_English.aux
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;pandocのための設定&#34;&gt;pandocのための設定&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;word fileとして出力しても，スタイルが気に入らない可能性は高い．そこで，予めスタイルファイルを自分好みにしておく．&lt;/li&gt;
&lt;li&gt;参考サイト1：&lt;a href=&#34;https://github.com/jgm/pandoc/wiki/Defining-custom-DOCX-styles-in-LibreOffice-(and-Word)&#34;&gt;Defining custom DOCX styles in LibreOffice (and Word)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;参考サイト2：&lt;a href=&#34;https://support.office.com/en-us/article/Customize-styles-in-Word-for-Mac-1ef7d8e1-1506-4b21-9e81-adc5f698f86a&#34;&gt;Customize styles in Word for Mac&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;参考サイト3：&lt;a href=&#34;https://qiita.com/sky%5Fy/items/5fd5c9568ea550b1d7af&#34;&gt;ドキュメント変換ツールPandoc：ユーザーズガイドを熟読して分かったマニアックな使い方&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;上記のサイトを参考にスタイルファイルを作成し，~/.pandocにword用に &lt;strong&gt;reference.docx&lt;/strong&gt; として置く．このテンプレートのフォーマットに従ってword fileが出力される．&lt;/li&gt;
&lt;li&gt;しかし，実は，これが結構面倒くさいのである．念のため自作のものを&lt;a href=&#34;/files/reference.docx&#34;&gt;ここ&lt;/a&gt;に置いておく．&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;citation-style-language--csl--の設定&#34;&gt;Citation Style Language (CSL)の設定&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;参考サイト1：&lt;a href=&#34;https://citationstyles.org&#34;&gt;Citation Style Language&lt;/a&gt;  ご本家&lt;/li&gt;
&lt;li&gt;参考サイト2：&lt;a href=&#34;https://github.com/citation-style-language/styles&#34;&gt;citation-style-language/styles&lt;/a&gt; スタイルの在り処&lt;/li&gt;
&lt;li&gt;参考サイト3：&lt;a href=&#34;https://github.com/citation-style-language/styles/blob/master/stroke.csl&#34;&gt;citation-style-language/styles/stroke.csl&lt;/a&gt;  今回使用するスタイル&lt;/li&gt;
&lt;li&gt;CSLは学術出版の引用と文献スタイルの書式自動化を促進することを目的としたオープンソースプロジェクト．ありがたく使わせていただく．&lt;/li&gt;
&lt;li&gt;上記の&lt;a href=&#34;https://github.com/citation-style-language/styles/blob/master/stroke.csl&#34;&gt;参考サイト3&lt;/a&gt;からstroke.cslをダウンロードする．&lt;/li&gt;
&lt;li&gt;stroke.cslをexportの対象のorg fileと同じdirectoryに置いておく．&lt;/li&gt;
&lt;li&gt;これで，&lt;a href=&#34;https://www.ahajournals.org/journal/str&#34;&gt;Stroke&lt;/a&gt; という雑誌の引用書式に従ったスタイルになってword fileがexportされる．&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;英語論文の場合のorg-fileの設定&#34;&gt;英語論文の場合のorg fileの設定&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;ここからは，個々のorg-mode file側の設定である．&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;英語の場合は殆どなんの問題もなくexportされる．&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;早速実例を見てみる．まず下のorg fileをhogefuga_English.orgとして保存する．&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-lisp&#34; data-lang=&#34;lisp&#34;&gt;&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;LaTeX_CLASS: koma-article
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;LaTeX_CLASS_OPTIONS: [12pt]
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;LATEX_HEADER: \usepackage{times}
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;LATEX_HEADER: \usepackage{geometry}
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;LATEX_HEADER: \geometry{left=1in,right=1in,top=1in,bottom=1in}
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;LaTeX_HEADER: \usepackage[sort,compress,super,comma]{natbib}
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;STARTUP:  overview
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;STARTUP:  hidestars
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;OPTIONS:   H:3 num:nil toc:nil \n:nil @:t &lt;span style=&#34;color:#e6db74&#34;&gt;::t&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;|&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;:t&lt;/span&gt; ^:t -:t f:t *:t TeX:t LaTeX:t skip:nil d:nil todo:t pri:nil tags:not-in-toc DATE:nil
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;LINK_UP:
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;LINK_HOME:

&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;TITLE: Hogefuga profiling to identify distinct changes associated with hogefuga events in hogefuga disease
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;AUTHOR: taipapa, Nobunaga Oda, Hideyoshi Toyotomi, Ieyasu Tokugawa

 \vspace*{-1.5cm}

      \hspace{2.5cm} Department of Hogefuga, Hogefuga University

&lt;span style=&#34;color:#f92672&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;*&lt;/span&gt; Introduction

Stroke is estimated to be ranked as &lt;span style=&#34;color:#66d9ef&#34;&gt;the&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;second&lt;/span&gt; leading cause of death and &lt;span style=&#34;color:#66d9ef&#34;&gt;the&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;third&lt;/span&gt; most common cause of permanent disability around &lt;span style=&#34;color:#66d9ef&#34;&gt;the&lt;/span&gt; world.\cite{Donnan:2008ax} The proportion of ischemic stroke is more than 90% in all stroke. The underlying metabolomic pathophysiology of ischemic stroke, however, remains poorly understood.

Recently, metabolome analysis using &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;“&lt;/span&gt;omics&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;”&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;method&lt;/span&gt; has developed. Mass spectrometry (MS) and nuclear magnetic resonance (NMR) spectroscopy have garnered &lt;span style=&#34;color:#66d9ef&#34;&gt;the&lt;/span&gt; most use for profiling a large &lt;span style=&#34;color:#a6e22e&#34;&gt;number&lt;/span&gt; of metabolites simultaneously.\cite{Lewis:2008uq} These technologies offer comprehensive information about thousands of low-molecular mass compounds (less than 2kDa) including lipids, amino acids, peptides, nucleic acids, organic acids, vitamins, thiols and carbohydrates. Metabolomics renders &lt;span style=&#34;color:#66d9ef&#34;&gt;the&lt;/span&gt; metabolic profile of a system, &lt;span style=&#34;color:#66d9ef&#34;&gt;the&lt;/span&gt; end points of biological events, and reflect &lt;span style=&#34;color:#66d9ef&#34;&gt;the&lt;/span&gt; state of a cell or group of cells at a given time.\cite{Gerszten:2008uq} Gas-chromatography/mass-spectrometry (GC/MS) is one of &lt;span style=&#34;color:#66d9ef&#34;&gt;the&lt;/span&gt; wide-spread techniques, which enables researchers to determine analyte masses with such high precision and accuracy that peptides and metabolites can be identified unambiguously even in &lt;span style=&#34;color:#a6e22e&#34;&gt;complex&lt;/span&gt; fluids.\cite{Lewis:2010oq}

The profiling of low molecular weight biochemicals that serve as substrates and products in metabolic pathways is particularly relevant to cardiovascular diseases.\cite{Lewis:2008uq} At present, however, very few studies have been reported on metabolic profiling of stroke. Unlike myocardial infarction, metabolomic changes in &lt;span style=&#34;color:#66d9ef&#34;&gt;the&lt;/span&gt; brain are &lt;span style=&#34;color:#a6e22e&#34;&gt;not&lt;/span&gt; sufficiently reflected by blood biomarkers due to &lt;span style=&#34;color:#66d9ef&#34;&gt;the&lt;/span&gt; presence of &lt;span style=&#34;color:#66d9ef&#34;&gt;the&lt;/span&gt; blood-brain barrier and dilution by peripheral blood.\cite{kim2013biomarkers} In addition, most of &lt;span style=&#34;color:#66d9ef&#34;&gt;the&lt;/span&gt; studies focused on acute stage of stroke.\cite{Jiang:2011uq,Jung:2011fk,Kimberly:2013mq

&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;BIBLIOGRAPHY: /Users/taipapa/Documents/hogefuga-References.bib Stroke_6-authors.bst option:-a limit:t

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;何故か *Introductionの前に２つコンマを打たないとうまくhugoでブログにexportされない（理由は不明，ご教示を乞う）．このために画面上 *Introduction の前にコンマが一つ残っているが，もしコピーして試して見るなら，この余分なコンマは除かないとうまくいかないので注意していただきたい．&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Emacsで上記のhogefuga_English.orgを開いた状態で，C-c C-e l oとすると，pdfが作成され，下図のようにskimで開かれる．&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;






&lt;figure&gt;

  &lt;a data-fancybox=&#34;&#34; href=&#34;/img/hogefuga_English-pdf.jpg&#34; &gt;

&lt;img src=&#34;/img/hogefuga_English-pdf.jpg&#34; width=&#34;100%&#34; &gt;
&lt;/a&gt;

&lt;/figure&gt;

&lt;ul&gt;
&lt;li&gt;本文中に文献番号はついているし，文献リストもStrokeというジャーナルの投稿規定通り6人までの著者名は提示し，それ以上はet al. になっている．&lt;/li&gt;
&lt;li&gt;何故pdfを作成するかというと， &lt;strong&gt;文書の中で実際に引用された論文のみからなる文献リストを生成する&lt;/strong&gt; ためである．pdfと一緒にできたtex ファイルで，reftex-create-bibtex-file もしくは bibexportを使って抽出された文献リストであるextract.bibを作成する．&lt;/li&gt;
&lt;li&gt;実際に行った手順は以下の通りである．
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;pdfのexportの際に一緒に生成された &lt;strong&gt;hogefuga_English.tex&lt;/strong&gt; をEmacsで開く．&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;M-x reftex-create-bibtex-file&lt;/strong&gt; する&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;抽出された文献ファイルをextract.bibと命名し保存&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;しかし，extract.bibは何故か引用された8つの文献のうちの6つしか含まれていなかった．&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;そこで，上述のように &lt;strong&gt;bibexport&lt;/strong&gt; を利用することにした．texファイルをxelatexでコンパイルし，できたaux ファイルにbibexportを適用した．&lt;a href=&#34;../latexmk&#34;&gt;LaTeXをインストールし，texファイルが変更されると，自動的にcompileしてskimでのpdfも自動で更新されるようにする（2018年9月1日追記）&lt;/a&gt;のlatexmkの項を参照のこと．&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;$ latexmk -pvc -pdf -view&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;none hogefuga_English.tex
$ bibexport -o extract2.bib hogefuga_English.aux
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;これで，８つの文献をすべて含むextract2.bibが生成された．&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;英語論文のword-fileのexport&#34;&gt;英語論文のWord fileのexport&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;ようやくWord fileへexportできる段階となった．&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;上記で作成したhogefuga_Engolish.orgをEmacsでオープンし，冒頭に以下の3行を追加する．1行目は引用のスタイルファイルを指定し，2行目はWordのスタイルファイルを指定し，3行目は文書の中で実際に引用された文献のみのリストを指定している．この文献リストはorg-modeと同じdirectoryに置いておく．多分パスも効くが，この原稿専用のリストなので，同じdirectoryの方が混乱することがないであろう．&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-lisp&#34; data-lang=&#34;lisp&#34;&gt;&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;PANDOC_OPTIONS: csl:/Data/hoge/fuga/stroke.csl
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;PANDOC_OPTIONS: reference-doc:~/.pandoc/reference.docx
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;BIBLIOGRAPHY: extract2.bib
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;さらに，最後の文献についての以下の部分は削除する．&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-lisp&#34; data-lang=&#34;lisp&#34;&gt;&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;BIBLIOGRAPHY: /Users/taipapa/Documents/hogefuga-References.bib Stroke_3-authors_alphabetical.bst option:-a limit:t
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;以上で，下図のようになるので，hogefuga_English_WORD.org として保存する．&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-lisp&#34; data-lang=&#34;lisp&#34;&gt;&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;LaTeX_CLASS: koma-article
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;LaTeX_CLASS_OPTIONS: [12pt]
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;LATEX_HEADER: \usepackage{times}
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;LATEX_HEADER: \usepackage{geometry}
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;LATEX_HEADER: \geometry{left=1in,right=1in,top=1in,bottom=1in}
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;LaTeX_HEADER: \usepackage[sort,compress,super,comma]{natbib}
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;STARTUP:  overview
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;STARTUP:  hidestars
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;OPTIONS:   H:3 num:nil toc:nil \n:nil @:t &lt;span style=&#34;color:#e6db74&#34;&gt;::t&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;|&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;:t&lt;/span&gt; ^:t -:t f:t *:t TeX:t LaTeX:t skip:nil d:nil todo:t pri:nil tags:not-in-toc DATE:nil
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;PANDOC_OPTIONS: csl:/Data/Stroke2018/Survival_CEA_CAS-MN/stroke.csl
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;PANDOC_OPTIONS: reference-doc:~/.pandoc/reference.docx
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;BIBLIOGRAPHY: extract2.bib
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;LINK_UP:
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;LINK_HOME:

&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;TITLE: Hogefuga profiling to identify distinct changes associated with hogefuga events in hogefuga disease
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;AUTHOR: taipapa, Nobunaga Oda, Hideyoshi Toyotomi, Ieyasu Tokugawa.

         \vspace*{-1.5cm}

              \hspace{3cm} Department of Hogefuga, Hogefuga University

&lt;span style=&#34;color:#f92672&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;*&lt;/span&gt; Introduction
  Stroke is estimated to be ranked as &lt;span style=&#34;color:#66d9ef&#34;&gt;the&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;second&lt;/span&gt; leading cause of
  death and &lt;span style=&#34;color:#66d9ef&#34;&gt;the&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;third&lt;/span&gt; most common cause of permanent disability
  around &lt;span style=&#34;color:#66d9ef&#34;&gt;the&lt;/span&gt; world.\cite{Donnan:2008ax} The proportion of ischemic
  stroke is more than 90% in all stroke. The underlying metabolomic
  pathophysiology of ischemic stroke, however, remains poorly
  understood.

  Recently, metabolome analysis using &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;“&lt;/span&gt;omics&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;”&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;method&lt;/span&gt; has
  developed. Mass spectrometry (MS) and nuclear magnetic resonance
  (NMR) spectroscopy have garnered &lt;span style=&#34;color:#66d9ef&#34;&gt;the&lt;/span&gt; most use for profiling a large
  &lt;span style=&#34;color:#a6e22e&#34;&gt;number&lt;/span&gt; of metabolites simultaneously.\cite{Lewis:2008uq} These
  technologies offer comprehensive information about thousands of
  low-molecular mass compounds (less than 2kDa) including lipids,
  amino acids, peptides, nucleic acids, organic acids, vitamins,
  thiols and carbohydrates. Metabolomics renders &lt;span style=&#34;color:#66d9ef&#34;&gt;the&lt;/span&gt; metabolic profile
  of a system, &lt;span style=&#34;color:#66d9ef&#34;&gt;the&lt;/span&gt; end points of biological events, and reflect &lt;span style=&#34;color:#66d9ef&#34;&gt;the&lt;/span&gt;
  state of a cell or group of cells at a given
  time.\cite{Gerszten:2008uq} Gas-chromatography/mass-spectrometry
  (GC/MS) is one of &lt;span style=&#34;color:#66d9ef&#34;&gt;the&lt;/span&gt; wide-spread techniques, which enables
  researchers to determine analyte masses with such high precision and
  accuracy that peptides and metabolites can be identified
  unambiguously even in &lt;span style=&#34;color:#a6e22e&#34;&gt;complex&lt;/span&gt; fluids.\cite{Lewis:2010oq}

  The profiling of low molecular weight biochemicals that serve as
  substrates and products in metabolic pathways is particularly
  relevant to cardiovascular diseases.\cite{Lewis:2008uq} At present,
  however, very few studies have been reported on metabolic profiling
  of stroke. Unlike myocardial infarction, metabolomic changes in &lt;span style=&#34;color:#66d9ef&#34;&gt;the&lt;/span&gt;
  brain are &lt;span style=&#34;color:#a6e22e&#34;&gt;not&lt;/span&gt; sufficiently reflected by blood biomarkers due to &lt;span style=&#34;color:#66d9ef&#34;&gt;the&lt;/span&gt;
  presence of &lt;span style=&#34;color:#66d9ef&#34;&gt;the&lt;/span&gt; blood-brain barrier and dilution by peripheral
  blood.\cite{kim2013biomarkers} In addition, most of &lt;span style=&#34;color:#66d9ef&#34;&gt;the&lt;/span&gt; studies
  focused on acute stage of
  stroke.\cite{Jiang:2011uq, Jung:2011fk, Kimberly:2013mq}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;*Introductionの前のコンマについては前述のとおりである．&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;org-modeからword-fileへのexportの方法&#34;&gt;org-modeからWord fileへのexportの方法&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;ここで，C-c C-e とすると，exportのバッファが表示される．C-nで下の方まで下がると，下図のように, &lt;strong&gt;export via pandoc&lt;/strong&gt; のメニューが見える．そこで，p xとして，export via pandoc &amp;mdash;&amp;gt; to docx and openを選択する．&lt;/p&gt;






&lt;figure&gt;

  &lt;a data-fancybox=&#34;&#34; href=&#34;/img/org-C-c-C-e.jpg&#34; &gt;

&lt;img src=&#34;/img/org-C-c-C-e.jpg&#34; width=&#34;100%&#34; &gt;
&lt;/a&gt;

&lt;/figure&gt;

&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;暫く待つと，下図のようにWordが立ち上がって，docx file（ &lt;strong&gt;hogefuga_English_WORD.docx&lt;/strong&gt; ）が開かれる．&lt;/p&gt;






&lt;figure&gt;

  &lt;a data-fancybox=&#34;&#34; href=&#34;/img/hogefuga_English-WORD.jpg&#34; &gt;

&lt;img src=&#34;/img/hogefuga_English-WORD.jpg&#34; width=&#34;100%&#34; &gt;
&lt;/a&gt;

&lt;/figure&gt;

&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;全体的なスタイルはまずまずである．&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;本文中に文献番号はついているし，文献リストもStrokeというジャーナルの投稿規定通り6人までの著者名は提示し，それ以上はet al. になっている．&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;文献リストの体裁はインデントに問題ありだが，これは手作業でやっても苦痛でないレベルである．&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;org-modeのオプションが見えてしまっているが，この程度であれば僅かな手作業で消去できる．&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;英語に関しては，pdfと比べると多少見劣りがするが，まず問題ないレベルのWord fileが出力できた．&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;日本語論文の場合のorg-fileの設定&#34;&gt;日本語論文の場合のorg fileの設定&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;前回の記事（&lt;a href=&#34;../org-mode_paper_3&#34;&gt;Emacsのorg-modeで論文を書く（その3：org-modeとbibtexとreftexの連携による文献引用の自動化&lt;/a&gt;）の際に作成したhogefuga.orgをEmacsでオープンし，冒頭に以下の3行を追加する．1行目は引用のスタイルファイルを指定し，2行目はWordのスタイルファイルを指定し，3行目は文書の中で実際に引用された文献のみのリストを指定している．この文献リストはorg-modeと同じdirectoryに置いておく．&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-lisp&#34; data-lang=&#34;lisp&#34;&gt;&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;PANDOC_OPTIONS: csl:/Data/hoge/fuga/stroke.csl
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;PANDOC_OPTIONS: reference-doc:~/.pandoc/reference.docx
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;BIBLIOGRAPHY: extract.bib
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;さらに，最後の文献についての以下の部分は削除する．&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-lisp&#34; data-lang=&#34;lisp&#34;&gt;&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;BIBLIOGRAPHY: /Users/taipapa/Documents/hogefuga-References.bib Stroke_3-authors_alphabetical.bst option:-a limit:t
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;以上で，下図のようになるので，hogefuga_WORD.org として保存する．&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-lisp&#34; data-lang=&#34;lisp&#34;&gt;&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;LaTeX_CLASS: koma-jarticle
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;LaTeX_CLASS_OPTIONS: [12pt]
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;LATEX_HEADER: \usepackage{geometry}
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;LATEX_HEADER: \geometry{left=1in,right=1in,top=1in,bottom=1in}
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;LaTeX_HEADER: \usepackage[sort,compress,super,comma]{natbib}
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;STARTUP:  overview
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;STARTUP:  hidestars
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;OPTIONS:   H:4 num:nil toc:nil \n:nil @:t &lt;span style=&#34;color:#e6db74&#34;&gt;::t&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;|&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;:t&lt;/span&gt; ^:t -:t f:t *:t TeX:t LaTeX:t skip:nil d:nil todo:t pri:nil tags:not-in-toc
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;OPTIONS: date:nil
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;PANDOC_OPTIONS: csl:/Data/hoge/fuga/stroke.csl
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;PANDOC_OPTIONS: reference-doc:~/.pandoc/reference.docx
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;BIBLIOGRAPHY: extract.bib
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;LINK_UP:
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;LINK_HOME:

&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;TITLE: hoge/fugaによる相補的な治療における高難度症例の治療と成績
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;AUTHOR: taipapa, 織田信長, 豊臣秀吉, 徳川家康
\vspace*{-1.5cm}

\hspace{2.5cm} hogefuga大学大学院 hogefuga研究科 hogefuga分野

&lt;span style=&#34;color:#a6e22e&#34;&gt;*&lt;/span&gt; 背景と目的
hogeとfugaを比較してみると&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;，&lt;/span&gt;一方で難易度の高い症例でも他方では容易に行える場合も多い&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;．&lt;/span&gt;\cite{Stetler:2012jt}当施設では&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;，&lt;/span&gt;一方に片寄ることなく&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;，&lt;/span&gt;hogeとfugaを相補的に用いることにより合併症の減少を目指す方針をとっている&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;．&lt;/span&gt;そこで&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;，&lt;/span&gt;自験例から高難度のhogefuga症例についての方針と成績を主にhogefuga surgeonの立場から検討した&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;．&lt;/span&gt;
&lt;span style=&#34;color:#a6e22e&#34;&gt;*&lt;/span&gt; 結果
hogefuga症例の画像である (*Fig. [[hoge_fuga]]*)&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;．&lt;/span&gt;\cite{Cosentino:2011dn}

&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;NAME: hoge_fuga
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;caption: hoge-fuga&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;（&lt;/span&gt;重症例である&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;）&lt;/span&gt;
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;attr_latex: &lt;span style=&#34;color:#e6db74&#34;&gt;:float&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;t&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;:width&lt;/span&gt; 3in  &lt;span style=&#34;color:#e6db74&#34;&gt;:align&lt;/span&gt; center
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;ATTR_HTML: &lt;span style=&#34;color:#e6db74&#34;&gt;:width&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;500&lt;/span&gt;  &lt;span style=&#34;color:#e6db74&#34;&gt;:float:&lt;/span&gt; wrap &lt;span style=&#34;color:#e6db74&#34;&gt;:align&lt;/span&gt; center
[[./hoge_fuga.jpg]]

&lt;span style=&#34;color:#a6e22e&#34;&gt;*&lt;/span&gt; 結論
hogefugaによる治療は有効である&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;．&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;org-modeからword-fileへのexportの方法&#34;&gt;org-modeからWord fileへのexportの方法&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;ここで，C-c C-e とすると，exportのバッファが表示される．C-nで下の方まで下がると，下図のように, &lt;strong&gt;export via pandoc&lt;/strong&gt; のメニューが見える．そこで，p xとして，export via pandoc &amp;mdash;&amp;gt; to docx and openを選択する．&lt;/p&gt;






&lt;figure&gt;

  &lt;a data-fancybox=&#34;&#34; href=&#34;/img/org-C-c-C-e.jpg&#34; &gt;

&lt;img src=&#34;/img/org-C-c-C-e.jpg&#34; width=&#34;100%&#34; &gt;
&lt;/a&gt;

&lt;/figure&gt;

&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;暫く待つと，下図のようにWordが立ち上がって，docx file（ &lt;strong&gt;hogefuga_WORD.docx&lt;/strong&gt; ）が開かれる．&lt;/p&gt;






&lt;figure&gt;

  &lt;a data-fancybox=&#34;&#34; href=&#34;/img/word-1.jpg&#34; &gt;

&lt;img src=&#34;/img/word-1.jpg&#34; width=&#34;100%&#34; &gt;
&lt;/a&gt;

&lt;/figure&gt;

&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;本文中に文献番号はついているし，文献リストもStrokeというジャーナルの投稿規定通り6人までの著者名は提示し，それ以上はet al. になっている．&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Figureのキャプションが消えているが，通常，論文投稿時には，本文と画像は別々になるので，画像自体を本文から削除できるため，問題無しとする．&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;しかし，英語の場合には見られなかった大きな問題が発覚した！　本文が,  &lt;strong&gt;濁点分離&lt;/strong&gt; してしまっている．&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;word-file-の濁点分離を修正する方法&#34;&gt;Word file の濁点分離を修正する方法&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;濁点分離&lt;/strong&gt; したままでは使いものにならないので，修正する必要がある．しかし，Word fileの内容を点検して，いちいち手作業をやっていては堪らない．そこで，一気に濁点分離を修正する方法はないものかといろいろ探ってみた．&lt;/li&gt;
&lt;li&gt;参考サイト1：&lt;a href=&#34;https://ja.stackoverflow.com/questions/36762/word%E3%81%A7%E6%96%87%E6%9B%B8%E5%86%85%E3%81%AE%E6%96%87%E5%AD%97%E3%82%92unicode-nfc%E6%AD%A3%E8%A6%8F%E5%8C%96%E3%81%99%E3%82%8B%E6%96%B9%E6%B3%95&#34;&gt;Wordで文書内の文字をUnicode NFC正規化する方法&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;参考サイト2：&lt;a href=&#34;http://labs.timedia.co.jp/2018/04/post-57.html&#34;&gt;あらゆる文字に濁点と半濁点を付けてみよう&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;参考サイト3：&lt;a href=&#34;http://ikeikeikeike.hatenablog.com/entry/2013/11/20/121930&#34;&gt;Macの濁点問題を解決するPython unicodedataモジュール&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;参考サイト4：&lt;a href=&#34;http://emasaka.blog65.fc2.com/blog-entry-1407.html&#34;&gt;濁点問題&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;参考サイト5：&lt;a href=&#34;https://www.slideshare.net/emasaka/ss-82692529&#34;&gt;濁点の話&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;参考サイト6：&lt;a href=&#34;https://github.com/emasaka/docx-normarize-nfc&#34;&gt;docx-normarize-nfc&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;上記の参考サイト4, 5, 6では，emasaka氏により，pythonを用いた方法が報告されており，&lt;a href=&#34;https://github.com/emasaka/docx-normarize-nfc&#34;&gt;docx-normarize-nfc&lt;/a&gt; としてGithubにアップされている．これはpython scriptであり，.docxファイルをZIPアーカイブとして開き、文書本体のXMLテキストを開いてNFC正規化し、ZIPアーカイブに書き戻すというものであり，これを使わせてもらうことにした．&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;pythonの導入&#34;&gt;Pythonの導入&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;参考サイト：&lt;a href=&#34;https://www.python.org&#34;&gt;Welcome to Python.org&lt;/a&gt; （本家）ご存知いま一番アツい言語．それしか知らなくても下記のようにして使える（笑）&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;まず下準備としてpythonを入れる．&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;homebrew でpython3をインストール&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;$ brew install python3
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;docx-normarize-nfcの導入&#34;&gt;docx-normarize-nfcの導入&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/emasaka/docx-normarize-nfc&#34;&gt;docx-normarize-nfc&lt;/a&gt; からダウンロードして，/usr/local/bin/ にコピーする．（/usr/local/binにパスが通っているものとする）&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;濁点分離の修正&#34;&gt;濁点分離の修正&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;これでWord fileに対して上記のスクリプトを使用すれば良い．&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;念のために，Word fileの名前を，hogefuga_WORD_濁点分離修正済み.docxに変更し新規保存しておく．&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;そのうえで，shellで以下の操作を行う&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;$ docx-normarize-nfc hogefuga_WORD_濁点分離修正済み.docx
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;一瞬で修正は終わるので，ファイルをオープンして確かめてみると，下図のように修正されている．素晴らしい．&lt;/p&gt;






&lt;figure&gt;

  &lt;a data-fancybox=&#34;&#34; href=&#34;/img/word-fixed.jpg&#34; &gt;

&lt;img src=&#34;/img/word-fixed.jpg&#34; width=&#34;100%&#34; &gt;
&lt;/a&gt;

&lt;/figure&gt;

&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ようやく，使い物になる日本語のWord fileを作成することができた．&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;これで，英語でも日本語でも，pdfからWordにコピペして修正するという難行苦行から解放される．&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;しかし，co-authorとのすり合わせやrevisionの際は，まだ，Wordでの作業が必要とされる．苦行は続くのである．．．．．&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>Emacsのorg-modeで論文を書く（その3：org-modeとbibtexとreftexの連携による文献引用の自動化）</title>
      <link>/post/org-mode_paper_3/</link>
      <pubDate>Sat, 15 Sep 2018 00:00:00 +0900</pubDate>
      <guid>/post/org-mode_paper_3/</guid>
      <description>&lt;p&gt;前回（&lt;a href=&#34;../org-mode_paper_2&#34;&gt;Emacsのorg-modeで論文を書く（その2：BibDeskによる論文収集と整理）&lt;/a&gt;）は，BibDeskを用いて文献情報をbibtex ファイルとして収集する方法についてまとめた．今回は，この文献情報を利用した引用をEmacsのorg-modeでどのように自動化するかについてまとめる．早い話が，org-modeからlatexのbibtexとreftexの機能を利用するということになる．&lt;/p&gt;
&lt;h2&gt;Table of Contents&lt;/h2&gt;

&lt;h2 id=&#34;org-mode-reftex-setup&#34;&gt;org-mode-reftex-setup&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;参照サイト：&lt;a href=&#34;http://www.mfasold.net/blog/2009/02/using-emacs-org-mode-to-draft-papers/&#34;&gt;Using Emacs Org-mode to Draft Papers&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;RefTex-ModeというものがEmacsには含まれている．文献や引用の管理のためのパッケージである．詳細はC-h iでマニュアルを見れば分かる，と言いたいところだが，このマニュアルが膨大である．そこで，RefTeX in a Nutshellという2ページほどの要約を読めば，使うのには十分であるとマニュアル自体に書いてある（笑）．実は私はそれすらろくに読んでいないが，以下のように設定すれば，十分に使える．設定方法は，以前の記事（&lt;a href=&#34;../init_org&#34;&gt;Emacsの設定（その2）設定ファイル（init.el）をorg-modeで管理する&lt;/a&gt;）に記載したとおり，init.orgに書き込めば良い．&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-lisp&#34; data-lang=&#34;lisp&#34;&gt;&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;begin_src emacs-lisp
(defun org-mode-reftex-setup ()
  (load-library &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;reftex&amp;#34;&lt;/span&gt;)
  (and (buffer-file-name)
       (file-exists-p (buffer-file-name))
       (reftex-parse-all))
  (define-key org-mode-map (kbd &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;C-c )&amp;#34;&lt;/span&gt;) &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;reftex-citation&lt;/span&gt;)
  )
(add-hook &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;org-mode-hook&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;org-mode-reftex-setup&lt;/span&gt;)
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;end_src
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;上記の設定により，参照サイトの説明のように，org-modeの中でreftex-citationの機能が働くようになる．&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;org-mode-reftex-setupの使用方法&#34;&gt;org-mode-reftex-setupの使用方法&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;org-modeで文書を書いている最中に文献を引用したい箇所で，C-c ) と打つ&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;すると，まず，どの文献リストを使うかを聞いてくるので，hogefuga-reference.bibなど使いたいリストの名前を打つ．前回説明した方法で収集した文献のbib ファイルが有るはずである．&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;次に，文献を絞り込むためにキーワードを打つように催促されるので，それを打つ．すると，そのキーワードを有する文献のリストがずらずらと並ぶ．下図の例では，stetler と著者名を打ったときの結果が下のバッファに表示されている．該当する文献にカーソルを持ってくるか，クリックして選択し，リターンを押せば決定され，本文の該当箇所にその論文の cite-key，つまり，\cite{Stetler:2012jt} が入力される．&lt;/p&gt;






&lt;figure&gt;

  &lt;a data-fancybox=&#34;&#34; href=&#34;/img/reftex.jpg&#34; &gt;

&lt;img src=&#34;/img/reftex.jpg&#34; width=&#34;100%&#34; &gt;
&lt;/a&gt;

&lt;/figure&gt;

&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;上図の下のバッファ内でも，C-sの検索機能は使えるので，さらに絞り込みが必要な際は便利である．以前の記事（&lt;a href=&#34;../prelude_install&#34;&gt;Emacsの設定（その1）Preludeの導入&lt;/a&gt;）で述べたようにpreludeを導入して，かつ，helmを有効にしておけば，下図のようにC-sでswiperが使えて更に便利である．（なお，下図では，まず，heat shock proteinと打ち，ズラッと並んだ真ん中のバッファでC-sとやってstetlerと打ったところである．一番下のバッファにstetlerで絞り込まれた候補が並んでいる）&lt;/p&gt;






&lt;figure&gt;

  &lt;a data-fancybox=&#34;&#34; href=&#34;/img/reftex-2.jpg&#34; &gt;

&lt;img src=&#34;/img/reftex-2.jpg&#34; width=&#34;100%&#34; &gt;
&lt;/a&gt;

&lt;/figure&gt;

&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;ox-bibtex-dot-el&#34;&gt;&lt;a href=&#34;https://code.orgmode.org/bzg/org-mode/raw/master/contrib/lisp/ox-bibtex.el&#34;&gt;ox-bibtex.el&lt;/a&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;参考サイト：&lt;a href=&#34;https://aliquote.org/post/org-and-bibtex/&#34;&gt;Org and Bibtex&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;上述の作業で，文献を本文中にcite-keyとして引用することはできた．次に必要なのはorg-modeからpdfやhtmlにexportする際に，cite-keyをもとに，文献が雑誌の規定の様式で引用され，最後に文献リストが規定の様式で記述されるようにすることである．この面倒をみてくれるのが，&lt;a href=&#34;https://code.orgmode.org/bzg/org-mode/raw/master/contrib/lisp/ox-bibtex.el&#34;&gt;ox-bibtex.el&lt;/a&gt; である．&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ox-bibtex.elは，org-plus-contrib packageの中に含まれているので，まず，org-plus-contribをインストールする．これは，&lt;a href=&#34;http://emacs-jp.github.io/packages/package-management/package-el.html&#34;&gt;package.el&lt;/a&gt; を使えば簡単である．&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;次いで，use-packageを使って，ox-bibtexを設定する．と言っても以下のようにinit.orgに書くだけである．&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-lisp&#34; data-lang=&#34;lisp&#34;&gt;(&lt;span style=&#34;color:#a6e22e&#34;&gt;use-package&lt;/span&gt; ox-bibtex)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;なお，use-packageを使ってox-bibtexを設定する際に，defer t にすると，htmlへの文献のexportができなくなるので注意！&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;use-packageは非常に便利．emacsの新しいパッケージの導入と管理はこれでいいと思う．&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;参照サイト1：&lt;a href=&#34;https://github.com/jwiegley/use-package&#34;&gt;use-package&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;参照サイト2：&lt;a href=&#34;https://qiita.com/kai2nenobu/items/5dfae3767514584f5220&#34;&gt;use-packageで可読性の高いinit.elを書く&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ox-bibtex.elはbibtexをLaTeX, html, asciiにexportしてくれる．HTMLへのexportには，&lt;a href=&#34;https://www.lri.fr/~filliatr/bibtex2html/&#34;&gt;bibtex2html&lt;/a&gt; が使われる．そこで，bibtex2htmlをインストールしておく．homebrewがインストールされていれば以下のようにすれば良い．&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;brew install bibtex2html
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ox-bibtexの使い方はソースの最初に書いてあるとおりである．すなわち，文献をexportするためには，org-mode文書の冒頭に例えば以下を追加し，&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-lisp&#34; data-lang=&#34;lisp&#34;&gt;&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;LaTeX_HEADER: \usepackage[sort,compress,super,comma]{natbib}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;最後に，&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-lisp&#34; data-lang=&#34;lisp&#34;&gt;&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;BIBLIOGRAPHY: /Users/taipapa/Documents/hogefuga-references.bib Stroke_3-authors_alphabetical.bst option:-a limit:t
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;を追加する．&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;#+LaTeX_HEADER: の行の最後の&lt;a href=&#34;https://ctan.org/pkg/natbib&#34;&gt;natbib&lt;/a&gt; は，texliveに含まれる文献サポートのパッケージであり，1, 2, 3,&amp;hellip;.というような番号付タイプの文献引用や author-yearタイプの文献引用の両方に（それ以外にも）対応している．その手前はnatbibのオプションである．&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;#+BIBLIOGRAPHY: のあとにfoo.bibを書くわけだが，この部分はフルパスで書いて良い．その後にはスタイルを書く．上記のStroke_3-authors_alphabetical.bstは自作だが，これは投稿ジャーナルの規定に合わせて作成する．ジャーナルによってはbst ファイルを用意してあるかもしれない．&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;option: -foobar はbibtex2htmlに &amp;lsquo;foobar&amp;rsquo; を渡す．つまり&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-lisp&#34; data-lang=&#34;lisp&#34;&gt;option:-d    &lt;span style=&#34;color:#a6e22e&#34;&gt;sort&lt;/span&gt; by date
option:-a    &lt;span style=&#34;color:#a6e22e&#34;&gt;sort&lt;/span&gt; as BibTeX (usually by author) *default*
option:-u    unsorted i.e. same order as in &lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;bib file
option:-r    &lt;span style=&#34;color:#a6e22e&#34;&gt;reverse&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;the&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;sort&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;複数のオプションを使用することも可能&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-lisp&#34; data-lang=&#34;lisp&#34;&gt;option:-d option:-r
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;上述のように， &lt;strong&gt;limit:t&lt;/strong&gt; とすることにより，引用された文献のみのリストになる．これをしないと bib ファイルの中のすべての論文がリストになってしまう．&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;bst-ファイルについて&#34;&gt;bst ファイルについて&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;bibtexにおいて引用のスタイルを決めているファイルであり，これを目指すジャーナルの投稿規定に合わせる．既にそのようなbst ファイルがあれば極楽だが，ない場合は大変である．この辺は以下のサイトを参照．
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://www.ketsuago.com/entry/2015/03/16/231806&#34;&gt;LaTeXで参考文献の形式を変更する方法（bstファイルの編集）&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.med.osaka-u.ac.jp/pub/anes/www/html/manual/bibtex.html&#34;&gt;BibTeXのドキュメント&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;bst-ファイルの置き場所&#34;&gt;bst ファイルの置き場所&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;これにはかなり悩まされたが，なんのことはないMacTeXのFAQサイトに書いてあった．&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;http://www.tug.org/mactex/2013/faq/#qm05&#34;&gt;The Most Frequently Asked Questions (FAQ)&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;QM.06 :&lt;/strong&gt; Why can&#39;t the latest MacTeX find my local BibTeX files? Earlier versions of MacTeX worked correctly.  &lt;br /&gt;
&lt;br /&gt;
&lt;strong&gt;AM.06 :&lt;/strong&gt; TeX Live is slightly pickier about placement of these files. &amp;ldquo;.bib&amp;rdquo; files go in &lt;br /&gt;
&lt;strong&gt;~/Library/texmf/bibtex/bib&lt;/strong&gt; &lt;br /&gt;
or subfolders of this directory, and &amp;ldquo;.bst&amp;rdquo; files go in &lt;br /&gt;
&lt;strong&gt;~/Library/texmf/bibtex/bst&lt;/strong&gt; &lt;br /&gt;
or subfolders of this directory.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ここにおいておけば，パスを指定することなく，どこからでもbstファイルを指定してスタイルを決められる．&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;文献を引用したorg-modeからのexportの実例&#34;&gt;文献を引用したorg-modeからのexportの実例&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;ようやく，これで準備が整ったので，実例を示す．以下のファイルを作成し，hogefuga.orgとして保存する．&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-lisp&#34; data-lang=&#34;lisp&#34;&gt;&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;LaTeX_CLASS: koma-jarticle
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;LaTeX_CLASS_OPTIONS: [12pt]
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;LATEX_HEADER: \usepackage{geometry}
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;LATEX_HEADER: \geometry{left=1in,right=1in,top=1in,bottom=1in}
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;LaTeX_HEADER: \usepackage[sort,compress,super,comma]{natbib}
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;STARTUP:  overview
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;STARTUP:  hidestars
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;OPTIONS:   H:4 num:nil toc:nil \n:nil @:t &lt;span style=&#34;color:#e6db74&#34;&gt;::t&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;|&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;:t&lt;/span&gt; ^:t -:t f:t *:t TeX:t LaTeX:t skip:nil d:nil todo:t pri:nil tags:not-in-toc
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;OPTIONS: date:nil
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;LINK_UP:
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;LINK_HOME:

&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;TITLE: hoge/fugaによる相補的な治療における高難度症例の治療と成績
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;AUTHOR: taipapa, 織田信長, 豊臣秀吉, 徳川家康
\vspace*{-1.5cm}

\hspace{2.5cm} hogefuga大学大学院 hogefuga研究科 hogefuga分野

&lt;span style=&#34;color:#a6e22e&#34;&gt;*&lt;/span&gt; 背景と目的
hogeとfugaを比較してみると&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;，&lt;/span&gt;一方で難易度の高い症例でも他方では容易に行える場合も多い&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;．&lt;/span&gt;\cite{Stetler:2012jt}当施設では&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;，&lt;/span&gt;一方に片寄ることなく&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;，&lt;/span&gt;hogeとfugaを相補的に用いることにより合併症の減少を目指す方針をとっている&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;．&lt;/span&gt;そこで&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;，&lt;/span&gt;自験例から高難度のhogefuga症例についての方針と成績を主にhogefuga surgeonの立場から検討した&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;．&lt;/span&gt;
&lt;span style=&#34;color:#a6e22e&#34;&gt;*&lt;/span&gt; 結果
hogefuga症例の画像である (*Fig. [[hoge_fuga]]*)&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;．&lt;/span&gt;\cite{Cosentino:2011dn}

&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;NAME: hoge_fuga
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;caption: hoge-fuga&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;（&lt;/span&gt;重症例である&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;）&lt;/span&gt;
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;attr_latex: &lt;span style=&#34;color:#e6db74&#34;&gt;:float&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;t&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;:width&lt;/span&gt; 3in  &lt;span style=&#34;color:#e6db74&#34;&gt;:align&lt;/span&gt; center
&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;ATTR_HTML: &lt;span style=&#34;color:#e6db74&#34;&gt;:width&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;500&lt;/span&gt;  &lt;span style=&#34;color:#e6db74&#34;&gt;:float:&lt;/span&gt; wrap &lt;span style=&#34;color:#e6db74&#34;&gt;:align&lt;/span&gt; center
[[./hoge_fuga.jpg]]

&lt;span style=&#34;color:#a6e22e&#34;&gt;*&lt;/span&gt; 結論
hogefugaによる治療は有効である&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;．&lt;/span&gt;

&lt;span style=&#34;color:#f92672&#34;&gt;#+&lt;/span&gt;BIBLIOGRAPHY: /Users/taipapa/Documents/hogefuga-References.bib Stroke_3-authors_alphabetical.bst option:-a limit:t
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;hogefuga-References.bibの部分やbstの部分は，それぞれ該当するファイルに置き換えていただきたい．&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;\cite{Stetler:2012jt,Cosentino:2011dn} の部分は私のbibファイルにおけるcite-keyである．&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;C-c C-e l o で，文献が番号付きで引用されたpdfが作成され，skimで開く．&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;下図のように，文献リストも付いているし，本文中の番号をクリックすれば文献リストの該当論文にジャンプするリンク付きである．また，このbstでは著者名のアルファベット順を指定しているので，最初にでてきた文献が2に，二番目にでてきた文献が1になっていることに注意してほしい．さらに，著者名は3人までは全員記載し，4人以上の論文では4人目以降はet alになっている．bibtexの活用により，これらのことが自動的になされている．&lt;/p&gt;






&lt;figure&gt;

  &lt;a data-fancybox=&#34;&#34; href=&#34;/img/ref-pdf.jpg&#34; &gt;

&lt;img src=&#34;/img/ref-pdf.jpg&#34; width=&#34;100%&#34; &gt;
&lt;/a&gt;

&lt;/figure&gt;

&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ついで，htmlである．C-c C-e h o で，文献が番号付きで引用されたhtmlが作成され，browserで開く．&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;下図のように，文献リストも付いているし，本文中の番号をクリックすれば文献リストの該当論文にジャンプするリンク付きである．その他もpdfと同様であるが，文献リストにはabstractやDOIも追加される．投稿する際はpdfか，別記事のようにwordにしてしまうので，html出力の設定はこれ以上触っていない．&lt;/p&gt;






&lt;figure&gt;

  &lt;a data-fancybox=&#34;&#34; href=&#34;/img/ref-html.jpg&#34; &gt;

&lt;img src=&#34;/img/ref-html.jpg&#34; width=&#34;100%&#34; &gt;
&lt;/a&gt;

&lt;/figure&gt;

&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ようやく，文献付きの原稿の出力の設定にまでたどり着くことができた．次回はpandocを利用して，org-modeからword ファイルを出力する方法をまとめる．&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>Emacsのorg-modeで論文を書く（その2：BibDeskによる論文収集と整理）</title>
      <link>/post/org-mode_paper_2/</link>
      <pubDate>Wed, 12 Sep 2018 00:00:00 +0900</pubDate>
      <guid>/post/org-mode_paper_2/</guid>
      <description>&lt;p&gt;さて，前回（&lt;a href=&#34;../org-mode_paper_1&#34;&gt;Emacsのorg-modeで論文を書く（その1：pdfとhtmlへの出力）&lt;/a&gt;）はorg-modeによる論文本体の執筆に付いてまとめたわけだが，今回は論文引用の方法についてまとめる．と思ったのだが，論文を引用するためには，当然のことながら論文を収集しなければならない．そのうち膨大な数の論文の海に溺れることになる．そこで，収集した論文，つまり，pdfの整理をするソフトが必要になってくる．その引用も，書式や番号付を雑誌の規定に合わせて自動化してくれれば言うことはない．ということで，そのようなソフトについて書くことにする．有料ソフトの定番としては，EndoNoteがあるし，フリーソフトでは，&lt;a href=&#34;https://www.zotero.org&#34;&gt;zotero&lt;/a&gt;や&lt;a href=&#34;https://www.mendeley.com/?switchedFrom=&#34;&gt;Mendeley&lt;/a&gt;が有名である．私自身は，LaTeXを利用することが多い関係上，&lt;a href=&#34;https://bibdesk.sourceforge.io&#34;&gt;BibDesk&lt;/a&gt;というこれまた老舗のソフトをもっぱら利用している．ネット上でもzoteroやmendeleyについての情報は豊富だが，BibDeskについてはそれほど見られないので，まとめておくことは多少の意味があるであろうと考え，BibDeskによる論文収集を説明することにした．&lt;/p&gt;
&lt;h2 id=&#34;bibdesk&#34;&gt;&lt;a href=&#34;https://bibdesk.sourceforge.io&#34;&gt;BibDesk&lt;/a&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;texliveをインストールすればその中に入っているが，最新版はリンク先にあるので，そちらを落とすほうが良い．&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;文献をbibtexのファイルとして管理する．pdfとの関連付けができるので，書誌事項とpdfが一体化して管理できる．&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;http://www.bibtex.org&#34;&gt;bibtex&lt;/a&gt;に関しては，&lt;a href=&#34;https://qiita.com/SUZUKI%5FMasaya/items/14f9727845e020f8e7e9&#34;&gt;BiBTeXとは&lt;/a&gt; を参照&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;bibtexファイルなので，当然，latexの機能を用いて，文献の引用，引用スタイルの設定，文献リストの作成，文献リストのスタイルの設定などをすべて自動化できる．これが便利！&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;見た目はこんな感じ&lt;/p&gt;






&lt;figure&gt;

  &lt;a data-fancybox=&#34;&#34; href=&#34;/img/bibdesk.jpg&#34; &gt;

&lt;img src=&#34;/img/bibdesk.jpg&#34; width=&#34;100%&#34; &gt;
&lt;/a&gt;

&lt;/figure&gt;

&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;医学系の論文となると，やはり，&lt;a href=&#34;https://www.ncbi.nlm.nih.gov/pubmed&#34;&gt;PubMed&lt;/a&gt;などネットでの連携が重要である．下図のごとく，BibDeskではSearches menuからPubMedを選ぶことにより，BibDeskの中からPubMedを検索できる．&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;






&lt;figure&gt;

  &lt;a data-fancybox=&#34;&#34; href=&#34;/img/bibdesk-pubmed.jpg&#34; &gt;

&lt;img src=&#34;/img/bibdesk-pubmed.jpg&#34; width=&#34;100%&#34; &gt;
&lt;/a&gt;

&lt;/figure&gt;

&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;検索欄に，例えば，&amp;ldquo;heat shock protein&amp;quot;と打つと，下図のように検索結果が50編ずつ並ぶが，50編以上ある場合は，Searchを繰り返しクリックすることにより，100編と150編とどんどんリストに取り込まれていく．&lt;/p&gt;






&lt;figure&gt;

  &lt;a data-fancybox=&#34;&#34; href=&#34;/img/bibdesk-pubmed2.jpg&#34; &gt;

&lt;img src=&#34;/img/bibdesk-pubmed2.jpg&#34; width=&#34;100%&#34; &gt;
&lt;/a&gt;

&lt;/figure&gt;

&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;上図のごとく，検索結果欄の左端に&amp;quot;Import&amp;rdquo; ボタンがあるが，これをクリックするとその論文の書誌事項が取り込まれる．その際に，自分の文献リストの名前を，&amp;ldquo;hogefuga-reference.bib&amp;rdquo; など適当に決めれば良い．以後はそのリストに追加していくことになる．&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;また，取り込まれる際にcite-keyをBibDeskが自動的に決めてくれる．このcite-keyは次回の記事で述べる「引用の自動化」の際にreftexに使用される．&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;なお，PubMedの番号，つまり，Pmidが分かっていれば，それを打ち込めば一発で書誌事項を検索できる．&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;リストの中から興味のある論文をクリックして選択し，グレーにハイライトさせると，下図のごとく右側のサイドパネルに，その論文のあるサイトを示すアイコンが表示される．これをクリックすれば，ブラウザーが開いてそのサイトに飛ぶ．もし，その論文がオープンアクセスであれば，あるいは，所属する組織が出版社と契約を交わしていれば，その論文のpdfを落とせる．落としたpdfをドラッグしてその論文に該当するリストのラインにドロップすれば，その書誌事項とpdfはリンクし，以降はその論文のサイドパネルにpdfのアイコンが表示され，ダブルクリックによりオープンするようになる．さらに言えば，pdfではなく，パワポやワードのファイルとして文献が存在することもある．同じようにドラッグ＆ドロップすれば，これまたリンクする．しかも一つの文献にいくつものpdfやその他のファイルをリンクできる．非常に便利である．&lt;/p&gt;






&lt;figure&gt;

  &lt;a data-fancybox=&#34;&#34; href=&#34;/img/bibdesk-pubmed3.jpg&#34; &gt;

&lt;img src=&#34;/img/bibdesk-pubmed3.jpg&#34; width=&#34;100%&#34; &gt;
&lt;/a&gt;

&lt;/figure&gt;

&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;また，下図のごとく，左のサイドパネルの一番上の方にある&amp;quot;Web BibDesk Web Group&amp;quot;をクリックして選択すれば，更にいろいろな文献ソースが表示される．医学系では，Google Scholarが有用なので，これをクリックすれば，BibDeskの中からGoogle Scholarを検索できるし，書誌事項も取り込める．pdfのリンクが存在すればBibDeskの中でpdfを落とすこともできる．&lt;/p&gt;






&lt;figure&gt;

  &lt;a data-fancybox=&#34;&#34; href=&#34;/img/bibdesk-pubmed4.jpg&#34; &gt;

&lt;img src=&#34;/img/bibdesk-pubmed4.jpg&#34; width=&#34;100%&#34; &gt;
&lt;/a&gt;

&lt;/figure&gt;

&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;収集した文献の書誌事項はhogefuga-reference.bibにbibtex fileとしてまとめられているが，その中身は以下のような情報の集積である（下の例ではabstractなどは省略している）．&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-tex&#34; data-lang=&#34;tex&#34;&gt;@article{Rothwell:2018aa,

  Author = {Rothwell, Peter M and Cook, Nancy R and Gaziano, J Michael and Price, Jacqueline F and Belch, Jill F F and Roncaglioni, Maria Carla and Morimoto, Takeshi and Mehta, Ziyah},
  Date-Added = {2018-08-03 22:46:26 +0900},
  Date-Modified = {2018-08-03 22:46:26 +0900},
  Doi = {10.1016/S0140-6736(18)31133-4},
  Journal = {Lancet},
  Journal-Full = {Lancet (London, England)},
  Month = {Jul},
  Pmid = {30017552},
  Pst = {aheadofprint},
  Title = {Effects of aspirin on risks of vascular events and cancer according to bodyweight and dose: analysis of individual patient data from randomised trials},
  Year = {2018},
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;bibtexなので，前述のごとく，文献の引用，引用スタイルの設定，文献リストの作成，文献リストのスタイルの設定などをすべて自動化できる．&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Emacsのorg-modeと組み合わせて，どのように文献の引用を自動化するかについては次回の記事にまとめる．&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
  </channel>
</rss>
